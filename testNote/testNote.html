<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="icon" href="/blog/logo.png"><title>学习笔记 📡 | xiehhy</title><meta name="description" content="My notes">
    <link rel="stylesheet" href="/blog/assets/css/styles.14fed409.css">
    <link rel="preload" href="/blog/assets/js/runtime~app.ef20b161.js" as="script"><link rel="preload" href="/blog/assets/css/styles.14fed409.css" as="style"><link rel="preload" href="/blog/assets/js/565.4944daae.js" as="script"><link rel="preload" href="/blog/assets/js/app.925ce17f.js" as="script">
    <link rel="prefetch" href="/blog/assets/js/testNote.html.61b1ea6c.js" as="script"><link rel="prefetch" href="/blog/assets/js/get-started.html.6ed08d94.js" as="script"><link rel="prefetch" href="/blog/assets/js/maths.html.f9f90a61.js" as="script"><link rel="prefetch" href="/blog/assets/js/index.html.a32c8101.js" as="script"><link rel="prefetch" href="/blog/assets/js/404.html.4574520d.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/blog/"><img class="logo" src="/blog/logo.png" alt="xiehhy"><span class="site-name can-hide" aria-hidden="true">xiehhy</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/blog/" aria-label="Home"><!--[--><!--[--><!--]--> Home <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/blog/get-started.html" aria-label="Get Started"><!--[--><!--[--><!--]--> Get Started <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/blog/math/maths.html" aria-label="高数 "><!--[--><!--[--><!--]--> 高数  <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/blog/testNote/testNote.html" aria-label="软件测试"><!--[--><!--[--><!--]--> 软件测试 <!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/blog/" aria-label="Home"><!--[--><!--[--><!--]--> Home <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/blog/get-started.html" aria-label="Get Started"><!--[--><!--[--><!--]--> Get Started <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/blog/math/maths.html" aria-label="高数 "><!--[--><!--[--><!--]--> 高数  <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/blog/testNote/testNote.html" aria-label="软件测试"><!--[--><!--[--><!--]--> 软件测试 <!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">学习笔记 📡 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#〇、-webdriver-、-browser-和-driver-的关系" aria-label="〇、&quot;WebDriver&quot;、&quot;Browser&quot;和&quot;driver&quot;的关系"><!--[--><!--[--><!--]--> 〇、&quot;WebDriver&quot;、&quot;Browser&quot;和&quot;driver&quot;的关系 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#一、selenium环境搭建" aria-label="一、selenium环境搭建"><!--[--><!--[--><!--]--> 一、selenium环境搭建 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#第一步-安装selenium包" aria-label="第一步：安装selenium包"><!--[--><!--[--><!--]--> 第一步：安装selenium包 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#第二步-下载对应的浏览器和驱动" aria-label="第二步：下载对应的浏览器和驱动"><!--[--><!--[--><!--]--> 第二步：下载对应的浏览器和驱动 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#二、与浏览器交互" aria-label="二、与浏览器交互"><!--[--><!--[--><!--]--> 二、与浏览器交互 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#和浏览器有关的属性和方法" aria-label="和浏览器有关的属性和方法"><!--[--><!--[--><!--]--> 和浏览器有关的属性和方法 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#一个例子" aria-label="一个例子"><!--[--><!--[--><!--]--> 一个例子 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#处理弹窗" aria-label="处理弹窗"><!--[--><!--[--><!--]--> 处理弹窗 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#三、元素定位" aria-label="三、元素定位"><!--[--><!--[--><!--]--> 三、元素定位 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#定位找到的第一个元素" aria-label="定位找到的第一个元素"><!--[--><!--[--><!--]--> 定位找到的第一个元素 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#定位多个元素" aria-label="定位多个元素"><!--[--><!--[--><!--]--> 定位多个元素 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#定位用法举例" aria-label="定位用法举例"><!--[--><!--[--><!--]--> 定位用法举例 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#几个例子" aria-label="几个例子"><!--[--><!--[--><!--]--> 几个例子 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#xpath" aria-label="XPATH"><!--[--><!--[--><!--]--> XPATH <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#一个测试的例子" aria-label="一个测试的例子"><!--[--><!--[--><!--]--> 一个测试的例子 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#四、元素的属性和方法" aria-label="四、元素的属性和方法"><!--[--><!--[--><!--]--> 四、元素的属性和方法 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#基本属性和方法" aria-label="基本属性和方法"><!--[--><!--[--><!--]--> 基本属性和方法 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#使用示例" aria-label="使用示例"><!--[--><!--[--><!--]--> 使用示例 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#例-获得文本框的值" aria-label="例：获得文本框的值"><!--[--><!--[--><!--]--> 例：获得文本框的值 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#例-获得链接" aria-label="例：获得链接"><!--[--><!--[--><!--]--> 例：获得链接 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#五、同步语句-隐式等待、显示等待" aria-label="五、同步语句（隐式等待、显示等待）"><!--[--><!--[--><!--]--> 五、同步语句（隐式等待、显示等待） <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#六、pom-page-object-model" aria-label="六、POM(Page Object Model)"><!--[--><!--[--><!--]--> 六、POM(Page Object Model) <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#pom介绍" aria-label="POM介绍"><!--[--><!--[--><!--]--> POM介绍 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#例-采用页面对象重新组织前面的例子" aria-label="例：采用页面对象重新组织前面的例子"><!--[--><!--[--><!--]--> 例：采用页面对象重新组织前面的例子 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#七、pytest的使用" aria-label="七、pytest的使用"><!--[--><!--[--><!--]--> 七、pytest的使用 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#安装" aria-label="安装"><!--[--><!--[--><!--]--> 安装 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#基础用法" aria-label="基础用法"><!--[--><!--[--><!--]--> 基础用法 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#参数化测试" aria-label="参数化测试"><!--[--><!--[--><!--]--> 参数化测试 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#设置和清理测试环境" aria-label="设置和清理测试环境"><!--[--><!--[--><!--]--> 设置和清理测试环境 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#八、日志记录的标准库——logging" aria-label="八、日志记录的标准库——logging"><!--[--><!--[--><!--]--> 八、日志记录的标准库——logging <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#基础用法-1" aria-label="基础用法"><!--[--><!--[--><!--]--> 基础用法 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#进阶用法" aria-label="进阶用法"><!--[--><!--[--><!--]--> 进阶用法 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#完整示例" aria-label="完整示例"><!--[--><!--[--><!--]--> 完整示例 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#附录-formatter类" aria-label="附录：Formatter类"><!--[--><!--[--><!--]--> 附录：Formatter类 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#九、使用allure产生测试结果报告" aria-label="九、使用allure产生测试结果报告"><!--[--><!--[--><!--]--> 九、使用allure产生测试结果报告 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#allure的安装和使用" aria-label="Allure的安装和使用"><!--[--><!--[--><!--]--> Allure的安装和使用 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#在报告中显示期待结果和实际结果" aria-label="在报告中显示期待结果和实际结果"><!--[--><!--[--><!--]--> 在报告中显示期待结果和实际结果 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#作业-登录测试练习" aria-label="作业：登录测试练习"><!--[--><!--[--><!--]--> 作业：登录测试练习 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#十、jenkins安装和使用-待续" aria-label="十、Jenkins安装和使用（待续）"><!--[--><!--[--><!--]--> 十、Jenkins安装和使用（待续） <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#附录-venv的使用" aria-label="附录：venv的使用"><!--[--><!--[--><!--]--> 附录：venv的使用 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#附录-浏览器控制台常见输入" aria-label="附录：浏览器控制台常见输入"><!--[--><!--[--><!--]--> 附录：浏览器控制台常见输入 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#附录-f-string-格式化字符串字面量" aria-label="附录：f-string（格式化字符串字面量）"><!--[--><!--[--><!--]--> 附录：f-string（格式化字符串字面量） <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#附录-逐行读取csv文件的内容" aria-label="附录：逐行读取csv文件的内容"><!--[--><!--[--><!--]--> 附录：逐行读取csv文件的内容 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#附录-一个不理解的问题" aria-label="附录：一个不理解的问题"><!--[--><!--[--><!--]--> 附录：一个不理解的问题 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#附录-参考资料" aria-label="附录：参考资料"><!--[--><!--[--><!--]--> 附录：参考资料 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="学习笔记" tabindex="-1"><a class="header-anchor" href="#学习笔记"><span>学习笔记 📡</span></a></h1><h2 id="〇、-webdriver-、-browser-和-driver-的关系" tabindex="-1"><a class="header-anchor" href="#〇、-webdriver-、-browser-和-driver-的关系"><span>〇、&quot;WebDriver&quot;、&quot;Browser&quot;和&quot;driver&quot;的关系</span></a></h2><p>&quot;WebDriver&quot;、&quot;浏览器&quot;和&quot;驱动程序&quot;（&quot;driver&quot;）之间存在密切的关系，特别是在进行 Web 自动化测试时。下面是它们之间的关系解释：</p><ol><li><p>WebDriver：WebDriver 是一个用于自动化控制浏览器的接口和工具。它提供了一组方法和功能，使开发人员能够通过编程方式与浏览器进行交互，模拟用户在浏览器中的行为。WebDriver 支持多种编程语言，如 Python、Java、JavaScript 等。通过 WebDriver，您可以打开浏览器、导航到网页、查找元素、执行操作（如点击、输入文本等）以及获取页面内容等。</p></li><li><p>浏览器：浏览器是用于显示和访问网页的软件应用程序。常见的浏览器包括 Chrome、Firefox、Safari、Edge 等。每个浏览器都有自己的特性、用户界面和渲染引擎。在 Web 自动化测试中，您可以使用 WebDriver 来控制这些浏览器，并与其进行交互。</p></li><li><p>驱动程序（driver）：驱动程序是连接 WebDriver 和浏览器的桥梁。由于每个浏览器都有不同的实现和交互方式，WebDriver 需要与每个浏览器配合使用特定的驱动程序。这些驱动程序负责与浏览器通信，并将 WebDriver 的命令翻译为浏览器能够理解和执行的操作。例如，对于 Chrome 浏览器，需要使用 ChromeDriver 作为驱动程序；对于 Firefox 浏览器，需要使用 GeckoDriver；对于 Safari 浏览器，需要使用 SafariDriver。</p></li></ol><p>因此，要使用 WebDriver 控制特定浏览器，您需要下载和配置相应的驱动程序，并通过编程语言的 WebDriver 接口与驱动程序进行交互。这样，您就可以编写自动化脚本来控制浏览器，模拟用户与网页的交互行为。</p><h2 id="一、selenium环境搭建" tabindex="-1"><a class="header-anchor" href="#一、selenium环境搭建"><span>一、selenium环境搭建</span></a></h2><h3 id="第一步-安装selenium包" tabindex="-1"><a class="header-anchor" href="#第一步-安装selenium包"><span>第一步：安装selenium包</span></a></h3><p>一个项目所使用的python可以采用：</p><p>⑴操作系统中安装的全局python；</p><p>⑵项目内建立的python虚拟环境。</p><p>项目使用不同的python环境，就需要在相应的环境中安装selenium。</p><h4 id="本地python环境中安装selenium" tabindex="-1"><a class="header-anchor" href="#本地python环境中安装selenium"><span>本地Python环境中安装selenium</span></a></h4><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pip <span class="token function">install</span> selenium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="虚拟环境中安装selenium" tabindex="-1"><a class="header-anchor" href="#虚拟环境中安装selenium"><span>虚拟环境中安装selenium</span></a></h4><p>激活虚拟环境后使用</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pip <span class="token function">install</span> selenium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>激活虚拟环境的方法参考附录&quot;venv的使用&quot;.</p><p><strong>例：Pycharm中配置虚拟环境并安装selenium</strong></p><p>以下以Pycharm为例，说明在IDE中配置虚拟环境并在虚拟环境中安装selenium的方法。</p><ol><li>自行到网站下载PyCharm community edition</li><li>新建python项目，选中iterpreter type: venv，然后确认创建项目。 <a href="#" title="## 目    录">//</a>: # (![image](images/ceFpeSlDDfr2oc7EVHtQ9WB2OI0DOWU6zyVWbef_qS4.png))</li><li>在 PyCharm 中安装 Selenium 包，您可以按照以下步骤进行操作： <ol><li><p>在 PyCharm 的顶部菜单中，选择 <strong>&quot;File&quot;（文件）&gt; &quot;Settings&quot;（设置）</strong>（在 macOS 上选择 &quot;PyCharm&quot; &gt; &quot;Preferences&quot;）。</p></li><li><p>在设置对话框中，展开** &quot;Project&quot;（项目）&gt; &quot;Project Interpreter&quot;（项目解释器）**。</p></li><li><p>在右侧的项目解释器列表中，选择您正在使用的 Python 解释器。</p></li><li><p>如果您尚未创建虚拟环境，建议创建一个虚拟环境以隔离项目的依赖关系。您可以使用 PyCharm 内置的虚拟环境管理工具或者使用 venv 命令创建虚拟环境</p></li><li><p>单击右侧的** &quot;+&quot; 图标**，以打开 &quot;Available Packages&quot;（可用包）对话框。</p></li><li><p>在搜索框中输入 &quot;selenium&quot;，然后按下 Enter 键或单击搜索按钮。</p></li><li><p>在搜索结果列表中，找到 Selenium 包，并单击其左侧的复选框。</p></li><li><p>单击 &quot;Install Package&quot;（安装包）按钮，PyCharm 将开始下载和安装 Selenium 包。</p></li><li><p>安装完成后，关闭对话框，并返回到 PyCharm 的编辑界面。</p></li></ol></li></ol><p>现在，您可以在项目中的 Python 文件中导入和使用 Selenium 包了。您可以使用 <code>import selenium</code> 语句导入 Selenium 模块，并开始编写自动化测试脚本或其他与浏览器交互的代码。</p><h3 id="第二步-下载对应的浏览器和驱动" tabindex="-1"><a class="header-anchor" href="#第二步-下载对应的浏览器和驱动"><span>第二步：下载对应的浏览器和驱动</span></a></h3><p>为了规避兼容性问题，请下载对应的浏览器和驱动，并在selenium的代码中明确的指定这两者的位置。</p><p><strong>网址：https://googlechromelabs.github.io/chrome-for-testing/</strong></p><p>代码如下：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>service <span class="token keyword">import</span> Service <span class="token keyword">as</span> ChromeService

<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

<span class="token comment"># 替换为您实际的Chrome浏览器路径，采用版本匹配的webdriver和chrome</span>

<span class="token comment"># 参见：</span>

<span class="token comment"># https://googlechromelabs.github.io/chrome-for-testing/</span>

chrome_path <span class="token operator">=</span> <span class="token string">&quot;/home/aug/Apps/chrome-linux64/chrome&quot;</span>

driver_path <span class="token operator">=</span> <span class="token string">&quot;/home/aug/bin/chromedriver&quot;</span>

chrome_options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>

chrome_options<span class="token punctuation">.</span>binary_location <span class="token operator">=</span> chrome_path

service <span class="token operator">=</span> ChromeService<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>driver_path<span class="token punctuation">)</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>service<span class="token operator">=</span>service<span class="token punctuation">,</span> options<span class="token operator">=</span>chrome_options<span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、与浏览器交互" tabindex="-1"><a class="header-anchor" href="#二、与浏览器交互"><span>二、与浏览器交互</span></a></h2><h3 id="和浏览器有关的属性和方法" tabindex="-1"><a class="header-anchor" href="#和浏览器有关的属性和方法"><span>和浏览器有关的属性和方法</span></a></h3><h3 id="一个例子" tabindex="-1"><a class="header-anchor" href="#一个例子"><span>一个例子</span></a></h3><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">class</span> <span class="token class-name">TestCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>set_window_size<span class="token punctuation">(</span><span class="token number">1920</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span> 

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    
    <span class="token keyword">def</span> <span class="token function">__del__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
<span class="token comment">#        self.driver.close() # 关闭当前tab</span>

<span class="token comment">#        self.driver.quit() # 关闭浏览器</span>

<span class="token comment">#        print(&quot;看看浏览器是否关闭&quot;) # 前两句并没有起作用</span>

        <span class="token keyword">pass</span>
              
    <span class="token keyword">def</span> <span class="token function">close</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 关闭当前tab</span>
        
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 关闭浏览器</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;看看浏览器是否关闭&quot;</span><span class="token punctuation">)</span> <span class="token comment"># 前两句并没有起作用</span>

    <span class="token keyword">def</span> <span class="token function">test_prop</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment"># 浏览器名称 </span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>current_url<span class="token punctuation">)</span> 

        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>window_handles<span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source<span class="token punctuation">)</span>
     
    <span class="token keyword">def</span> <span class="token function">test_method</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        elem <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span>

        elem<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;su&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>

        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span><span class="token punctuation">)</span>

        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">#self.driver.close() # 关闭当前tab</span>

        <span class="token comment">#self.driver.quit() # 关闭浏览器</span>
       
<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>

    <span class="token keyword">case</span> <span class="token operator">=</span> TestCase<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">case</span><span class="token punctuation">.</span>test_prop<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">case</span><span class="token punctuation">.</span>test_method<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">case</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="处理弹窗" tabindex="-1"><a class="header-anchor" href="#处理弹窗"><span>处理弹窗</span></a></h3><p>1. 三种弹窗：</p><p>A. Alert</p><p></p><p>B. Confirm</p><p></p><p>C. Prompt</p><p></p><p>2. 建立包含三种弹窗的HTML脚本：alert.html</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:alert(&#39;提示框&#39;)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>alert<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Alert<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:confirm(&#39;真的要删除数据吗?&#39;)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>confirm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Confirm<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:var age = prompt(&#39;你的年龄&#39;);document.write(age)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prompt<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Prompt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3. 编写webdriver脚本</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">import</span> os

<span class="token keyword">class</span> <span class="token class-name">TestCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

        path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span>

        url <span class="token operator">=</span> <span class="token string">&quot;file://&quot;</span><span class="token operator">+</span>path<span class="token operator">+</span><span class="token string">&quot;/alert.html&quot;</span> <span class="token comment"># file://///后无论多少个/都是一样的，至少2个。</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_alert</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;alert&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

        alert <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>alert <span class="token comment"># 无论是哪种弹窗，都是switch_to.alert</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>alert<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

        alert<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_prompt</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;prompt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

        prompt <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>alert

        prompt<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">&quot;20&quot;</span><span class="token punctuation">)</span> <span class="token comment"># 提示框中输入20</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>prompt<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

        prompt<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#        prompt.dismiss()</span>
        
    <span class="token keyword">def</span> <span class="token function">test_comfirm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;confirm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

        confirm <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>alert

        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

        confirm<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>
  
<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>

    <span class="token keyword">case</span> <span class="token operator">=</span> TestCase<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#    case.test_alert()</span>

<span class="token comment">#    case.test_prompt()</span>

    <span class="token keyword">case</span><span class="token punctuation">.</span>test_comfirm<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、元素定位" tabindex="-1"><a class="header-anchor" href="#三、元素定位"><span>三、元素定位</span></a></h2><h3 id="定位找到的第一个元素" tabindex="-1"><a class="header-anchor" href="#定位找到的第一个元素"><span>定位找到的第一个元素</span></a></h3><p>Selenium Python follows different locating strategies for elements. One can locate a element in 8 different ways. Here is a list of locating strategies for Selenium in python：</p><p>|Locators|描述|</p><p>| ----- | ----- |</p><p>|<a href="https://www.geeksforgeeks.org/find_element_by_id-driver-method-selenium-python/" target="_blank" rel="noopener noreferrer">find_element_by_id<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回 id 属性值与位置匹配的第一个元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_element_by_name-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_element_by_name<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回名称属性值与位置匹配的第一个元素。|</p><p>|<strong>find_element_by_xpath</strong>|将返回 xpath 语法与位置匹配的第一个元素。|</p><p>|<strong>find_element_by_link_text</strong>|将返回链接文本值与位置匹配的第一个元素。|</p><p>|<strong>find_element_by_partial_link_text</strong>|将返回部分链接文本值与位置匹配的第一个元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_element_by_tag_name-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_element_by_tag_name<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回具有给定标签名称的第一个元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_element_by_class_name-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_element_by_class_name<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回具有匹配类属性名称的第一个元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_element_by_css_selector-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_element_by_css_selector<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回具有匹配 CSS 选择器的第一个元素。|</p><h3 id="定位多个元素" tabindex="-1"><a class="header-anchor" href="#定位多个元素"><span>定位多个元素</span></a></h3><p>Selenium Python follows different locating strategies for elements. One can locate multiple elements in 7 different ways. Here is a list of locating strategies for Selenium in python：</p><p>|Locators|描述|</p><p>| ----- | ----- |</p><p>|<a href="https://www.geeksforgeeks.org/find_elements_by_name-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_elements_by_name<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回名称属性值与位置匹配的所有元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_elements_by_xpath-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_elements_by_xpath<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回所有具有与该位置匹配的 xpath 语法的元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_elements_by_link_text-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_elements_by_link_text<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回链接文本值与位置匹配的所有元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_elements_by_partial_link_text-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_elements_by_partial_link_text<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回部分链接文本值与位置匹配的所有元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_elements_by_tag_name-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_elements_by_tag_name<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回具有给定标签名称的所有元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_elements_by_class_name-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_elements_by_class_name<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|将返回具有匹配类属性名称的所有元素。|</p><p>|<a href="https://www.geeksforgeeks.org/find_elements_by_css_selector-driver-method-selenium-python/?ref=rp" target="_blank" rel="noopener noreferrer">find_elements_by_css_selector<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>|所有具有匹配 CSS 选择器的元素都将被返回。|</p><h3 id="定位用法举例" tabindex="-1"><a class="header-anchor" href="#定位用法举例"><span>定位用法举例</span></a></h3><p>用法举例1：</p><p>用法举例2：find_elements返回一堆元素。上表中的系列find_element</p><p>用法举例：by_link_text和by_partial_link text只能作用在a元素中。</p><h3 id="几个例子" tabindex="-1"><a class="header-anchor" href="#几个例子"><span>几个例子</span></a></h3><h4 id="一个例子-by-xpath-a-starts-with-text-新闻" tabindex="-1"><a class="header-anchor" href="#一个例子-by-xpath-a-starts-with-text-新闻"><span>一个例子(By.XPATH, &#39;//a[starts-with(text(), &quot;新闻&quot;)]&#39;)</span></a></h4><p>例如：访问百度网站，并定位到“新闻”板块。实现这一目的所采用的方法是寻找以“新闻”作为内容开头的网页元素。其对应的XPATH语句为<code>&#39;//a[starts-with(text(), &quot;新闻&quot;)]&#39;。</code></p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

elem <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&#39;//a[starts-with(text(), &quot;新闻&quot;)]&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="一个例子-by-id" tabindex="-1"><a class="header-anchor" href="#一个例子-by-id"><span>一个例子(By.ID)</span></a></h4><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">&quot;selenium&quot;</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;su&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token comment"># &lt;class &#39;selenium.webdriver.remote.webelement.WebElement&#39;&gt;</span>

driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="一个例子-by-link-text" tabindex="-1"><a class="header-anchor" href="#一个例子-by-link-text"><span>一个例子(By.LINK_TEXT)</span></a></h4><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># import webdriver</span>

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token comment"># create webdriver object</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># set implicit wait time</span>

driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># seconds</span>

<span class="token comment"># get www.baidu.com</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># get element after 10 seconds</span>

element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span><span class="token string">&quot;图片&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># click element</span>

element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xpath" tabindex="-1"><a class="header-anchor" href="#xpath"><span>XPATH</span></a></h3><h4 id="xpath的基本语法" tabindex="-1"><a class="header-anchor" href="#xpath的基本语法"><span>XPATH的基本语法</span></a></h4><p>例子：多个属性同时筛选。</p><h4 id="xpath的内置函数" tabindex="-1"><a class="header-anchor" href="#xpath的内置函数"><span>XPATH的内置函数</span></a></h4><p>XPath 提供了一些内置函数，如 <code>text()</code>、<code>contains()</code> 和 <code>starts-with()</code>，用于在 XPath 表达式中进行文本匹配和筛选。</p><p>以下是这些函数的说明和示例用法：</p><ol><li><code>text()</code>: 用于匹配元素的文本内容。可以将其与其他元素或属性选择器结合使用，以根据元素的文本内容进行筛选。</li></ol><p>示例：选择包含特定文本的元素。</p><p><code>//p[text()=&#39;Hello, world!&#39;]</code>: 选择文本内容为 &quot;Hello, world!&quot; 的 <code>&lt;p&gt;</code> 元素。</p><ol start="2"><li><code>contains()</code>: 用于检查元素的文本内容是否包含指定的子字符串。可以在选择器中使用它来进行模糊匹配。</li></ol><p>示例：选择包含特定子字符串的元素。</p><p><code>//p[contains(text(), &#39;example&#39;)]</code>: 选择文本内容中包含 &quot;example&quot; 的 <code>&lt;p&gt;</code> 元素。</p><ol start="3"><li><code>starts-with()</code>: 用于检查元素的文本内容是否以指定的前缀开头。</li></ol><p>示例：选择以特定前缀开头的元素。</p><p><code>//h2[starts-with(text(), &#39;Chapter&#39;)]</code>: 选择文本内容以 &quot;Chapter&quot; 开头的 <code>&lt;h2&gt;</code> 元素。</p><ol start="4"><li><code>normalize-space()</code>: 用于移除文本中的额外空格，并将多个连续空格替换为单个空格，然后返回结果。</li></ol><p>示例：选择文本内容去除额外空格后为 &quot;Hello, world!&quot; 的元素。</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
//p[normalize-space(text())=&#39;Hello, world!&#39;]

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li><code>translate()</code>: 用于将文本中的某些字符替换为其他字符。它接受三个参数：原始字符串、要替换的字符集和替换字符集。</li></ol><p>示例：选择文本内容中将所有小写字母替换为大写字母的元素。</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
//p[translate(text(), &#39;abcdefghijklmnopqrstuvwxyz&#39;, &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;)]

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li><code>substring()</code>: 用于提取文本的子字符串。它接受两个参数：原始字符串和要提取的子字符串的起始位置。</li></ol><p>示例：选择文本内容以 &quot;Hello&quot; 开头的元素。</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
//p[starts-with(substring(text(), 1, 5), &#39;Hello&#39;)]

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="一个测试的例子" tabindex="-1"><a class="header-anchor" href="#一个测试的例子"><span>一个测试的例子</span></a></h3><p>下面的代码中完成了两个测试：</p><ol><li><p>验证python的主页页面标题中有“Python”单词</p></li><li><p>搜索框中输入pycon后，验证搜索结果页中确实显示了搜索结果。</p></li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># import all required frameworks</span>

<span class="token keyword">import</span> unittest

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys

<span class="token comment"># inherit TestCase Class and create a new test class</span>

<span class="token keyword">class</span> <span class="token class-name">PythonOrgSearch</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># initialization of webdriver</span>

    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># Test case method. It should always start with test_</span>

    <span class="token keyword">def</span> <span class="token function">test_search_in_python_org</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># get driver</span>

        driver <span class="token operator">=</span> self<span class="token punctuation">.</span>driver

        <span class="token comment"># get python.org using selenium</span>

        driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.python.org&quot;</span><span class="token punctuation">)</span>

        <span class="token comment"># assertion to confirm if title has python keyword in it</span>

        self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">&quot;Python&quot;</span><span class="token punctuation">,</span> driver<span class="token punctuation">.</span>title<span class="token punctuation">)</span>

        <span class="token comment"># locate element using name</span>

        elem <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> <span class="token string">&quot;q&quot;</span><span class="token punctuation">)</span>

        <span class="token comment"># send data</span>

        elem<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">&quot;pycon&quot;</span><span class="token punctuation">)</span>

        <span class="token comment"># receive data</span>

        elem<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>RETURN<span class="token punctuation">)</span>

        <span class="token keyword">assert</span> <span class="token string">&quot;No results found.&quot;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> driver<span class="token punctuation">.</span>page_source

    <span class="token comment"># cleanup method called after every test performed</span>

    <span class="token keyword">def</span> <span class="token function">tearDown</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># execute the script</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>

    unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="四、元素的属性和方法" tabindex="-1"><a class="header-anchor" href="#四、元素的属性和方法"><span>四、元素的属性和方法</span></a></h2><h3 id="基本属性和方法" tabindex="-1"><a class="header-anchor" href="#基本属性和方法"><span>基本属性和方法</span></a></h3><p>通过driver.find_element找到元素，函数返回的是WebElement对象。然后就可以与该对象交互。WebElement支持的属性和方法列举如下：</p><p>在自动化Web测试中，<code>WebElement</code>对象代表了一个DOM元素。在Selenium中，<code>WebElement</code>接口定义了一系列的方法和属性，用于与页面上的元素进行交互。以下是一些常见的<code>WebElement</code>属性和方法：</p><h4 id="属性" tabindex="-1"><a class="header-anchor" href="#属性"><span>属性</span></a></h4><ol><li><p><code>tag_name</code> - 获取元素的标签名。</p></li><li><p><code>text</code> - 获取元素的文本内容。</p></li><li><p><code>size</code> - 获取元素的尺寸（宽度和高度）。</p></li><li><p><code>location</code> - 获取元素在页面中的位置。</p></li><li><p><code>rect</code> - 获取元素的边界（位置和尺寸）。</p></li><li><p><code>id</code> - 获取元素的ID。</p></li></ol><h4 id="方法" tabindex="-1"><a class="header-anchor" href="#方法"><span>方法</span></a></h4><ol><li><p><code>click()</code> - 单击元素。</p></li><li><p><code>send_keys(*value)</code> - 向元素发送键值。</p></li><li><p><code>clear()</code> - 清除元素的文本内容，主要用于文本输入框。</p></li><li><p><code>submit()</code> - 提交表单，通常用于<code>&lt;input type=&quot;submit&quot;&gt;</code>或<code>&lt;button type=&quot;submit&quot;&gt;</code>元素。</p></li><li><p><code>is_displayed()</code> - 检查元素是否显示。</p></li><li><p><code>is_enabled()</code> - 检查元素是否可用。</p></li><li><p><code>is_selected()</code> - 检查元素是否被选中，主要用于复选框和单选按钮。</p></li><li><p><code>find_element(*locator)</code> - 查找第一个与指定locator匹配的子元素。</p></li><li><p><code>find_elements(*locator)</code> - 查找所有与指定locator匹配的子元素。</p></li><li><p><code>get_attribute(name)</code> - 获取元素指定属性的值。</p></li><li><p><code>css_property(name)</code> - 获取元素的CSS属性值。</p></li><li><p><code>value_of_css_property(name)</code> - 获取元素的CSS属性的计算值。</p></li></ol><h3 id="使用示例" tabindex="-1"><a class="header-anchor" href="#使用示例"><span>使用示例</span></a></h3><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
# 假设已经有一个WebElement对象名为element

element.click() # 单击元素

element.send_keys(&quot;Hello, World!&quot;) # 向元素发送文本

element.clear() # 清除元素的文本

element.submit() # 提交表单

element.is_displayed() # 检查元素是否显示

element.find_element(By.ID, &quot;child_id&quot;) # 查找子元素

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在实际使用时，你需要首先定位到页面上的元素，然后再调用这些方法或属性。例如，你可以使用<code>find_element</code>或<code>find_elements</code>方法定位到元素，然后对返回的<code>WebElement</code>对象进行操作</p><h3 id="例-获得文本框的值" tabindex="-1"><a class="header-anchor" href="#例-获得文本框的值"><span>例：获得文本框的值</span></a></h3><p>elem.get_attribute(&quot;value&quot;) or elem.get_property(&quot;value&quot;)</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

elem <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span>

elem<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">&quot;just now&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token comment">#空</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#输出：just now</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="例-获得链接" tabindex="-1"><a class="header-anchor" href="#例-获得链接"><span>例：获得链接</span></a></h3><p>Python脚本：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># import webdriver</span>

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token comment"># create webdriver object</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># get geeksforgeeks.org</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com/&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># get element</span>

element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> <span class="token string">&quot;图片&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># get text_length property</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>get_property<span class="token punctuation">(</span><span class="token string">&#39;href&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="五、同步语句-隐式等待、显示等待" tabindex="-1"><a class="header-anchor" href="#五、同步语句-隐式等待、显示等待"><span>五、同步语句（隐式等待、显示等待）</span></a></h2><p>Selenium Python 是用于测试自动化的优秀工具之一。 如今，大多数 Web 应用程序都使用 AJAX 技术。 当浏览器加载页面时，该页面内的元素可能会以不同的时间间隔加载。 这使得定位元素变得困难：如果 DOM 中尚不存在元素，则定位函数将引发 ElementNotVisibleException 异常。 使用等待，我们可以解决这个问题。 等待在执行的操作之间提供了一些间隙——主要是定位元素或使用该元素进行任何其他操作。 Selenium Webdriver 提供两种类型的等待 - 隐式等待和显式等待。 本文围绕 Selenium Python 中的隐式等待展开。</p><h4 id="隐式等待" tabindex="-1"><a class="header-anchor" href="#隐式等待"><span>隐式等待</span></a></h4><p>隐式等待告诉 WebDriver 在尝试查找任何不立即可用的元素时轮询 DOM 一段时间。 默认设置为 0。设置后，将在 WebDriver 对象的生命周期内设置隐式等待。 让我们考虑一个例子——</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># import webdriver  </span>

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver  

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token comment"># create webdriver object  </span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    
<span class="token comment"># set implicit wait time </span>

driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># seconds </span>
  
<span class="token comment"># get geeksforgeeks.org  </span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>  

<span class="token comment"># get element after 10 seconds </span>

element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span><span class="token string">&quot;不存在的文本&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># click element </span>

element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span> 

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行后会得到：</p><blockquote><p>selenium.common.exceptions.NoSuchElementException: Message: Unable to locate element: 不存在的文本; For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception</p></blockquote><h4 id="显式等待" tabindex="-1"><a class="header-anchor" href="#显式等待"><span>显式等待</span></a></h4><p>显式等待是您定义的代码，用于等待特定条件发生，然后再继续执行代码。 这种情况的极端情况是 time.sleep()，它将条件设置为要等待的确切时间段。 显式等待提供了一些方便的方法，可以帮助您编写只等待所需时间的代码。 显式等待是通过结合使用 webdriverWait 类和预期条件来实现的。 让我们考虑一个例子——</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># import necessary classes</span>

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC

<span class="token comment"># create driver object</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># A URL that delays loading</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>

    <span class="token comment"># wait 10 seconds before looking for element</span>

    element <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>

        EC<span class="token punctuation">.</span>presence_of_element_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> <span class="token string">&quot;不存在的元素&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token punctuation">)</span>

    element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">except</span><span class="token punctuation">:</span>

    <span class="token comment"># else quit</span>

    driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">&quot;alert(&#39;没有找到该元素&#39;);&quot;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除了presence_of_element_located，其他常用的函数还有：</p><ul><li><p>title_is</p></li><li><p>title_contains</p></li><li><p>presence_of_element_located</p></li><li><p>visibility_of_element_located</p></li><li><p>visibility_of</p></li><li><p>presence_of_all_elements_located</p></li><li><p>element_located_to_be_selected</p></li><li><p>element_selection_state_to_be</p></li><li><p>element_located_selection_state_to_be</p></li><li><p>alert_is_present</p></li></ul><p>更多函数及其说明请参考链接：<a href="https://selenium-python.readthedocs.io/api.html#module-selenium.webdriver.support.expected_conditions" target="_blank" rel="noopener noreferrer">https://selenium-python.readthedocs.io/api.html#module-selenium.webdriver.support.expected_conditions<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="六、pom-page-object-model" tabindex="-1"><a class="header-anchor" href="#六、pom-page-object-model"><span>六、POM(Page Object Model)</span></a></h2><h3 id="pom介绍" tabindex="-1"><a class="header-anchor" href="#pom介绍"><span>POM介绍</span></a></h3><p>POM是页面对象模型(Page Object Model)的缩写,是一种基于对象思想的设计模式,用于实现UI自动化测试。</p><p>POM的主要思想是将Web页面的元素和操作封装成对象和方法,从而实现页面对象和功能测试脚本的分离,提高测试代码的可重用性和维护性。</p><p>实现POM一般包括以下步骤:</p><ol><li><p>将Web页面划分为多个逻辑区域</p></li><li><p>对每个区域创建一个Page对象类</p></li><li><p>Page对象类中包含页面元素定位器和页面操作方法</p></li><li><p>测试脚本通过实例化Page对象类并调用相应的方法来执行测试</p></li></ol><p>例如,对登录页面实现POM:</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># login_page.py</span>

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">class</span> <span class="token class-name">LoginPage</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> driver<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> driver

        self<span class="token punctuation">.</span>username_input <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>password_input <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>login_button <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>username_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>username<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>password_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>password<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>login_button<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># test_login.py</span>

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> login_page <span class="token keyword">import</span> LoginPage

<span class="token keyword">def</span> <span class="token function">test_login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

    login_page <span class="token operator">=</span> LoginPage<span class="token punctuation">(</span>driver<span class="token punctuation">)</span>

    login_page<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token string">&quot;myname&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mypassword&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># 其他验证步骤</span>

    driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="例-采用页面对象重新组织前面的例子" tabindex="-1"><a class="header-anchor" href="#例-采用页面对象重新组织前面的例子"><span>例：采用页面对象重新组织前面的例子</span></a></h3><h4 id="完整代码" tabindex="-1"><a class="header-anchor" href="#完整代码"><span>完整代码</span></a></h4><p>完整的代码有点长，建议先不阅读，等阅读完后面的要点解释后再重新阅读完整代码。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment">####################</span>

<span class="token comment"># PythonOrgSearch.py</span>

<span class="token comment">####################</span>

<span class="token keyword">import</span> unittest

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">import</span> page

<span class="token keyword">class</span> <span class="token class-name">PythonOrgSearch</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;A sample test class to show how page object works&quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.python.org&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_search_in_python_org</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;

        Tests python.org search feature. Searches for the word &quot;pycon&quot; then verified that some results show up.

        Note that it does not look for any particular text in search results page. This test verifies that

        the results were not empty.

        &quot;&quot;&quot;</span>

        <span class="token comment">#Load the main page. In this case the home page of Python.org.</span>

        main_page <span class="token operator">=</span> page<span class="token punctuation">.</span>MainPage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>

        <span class="token comment">#Checks if the word &quot;Python&quot; is in title</span>

        <span class="token comment"># 这是第一次测试，检查主页中的title中是否存在Python单词</span>

        <span class="token keyword">assert</span> main_page<span class="token punctuation">.</span>is_title_matches<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;python.org title doesn&#39;t match.&quot;</span>

        <span class="token comment">#Sets the text of search textbox to &quot;pycon&quot;</span>

        main_page<span class="token punctuation">.</span>search_text_element <span class="token operator">=</span> <span class="token string">&quot;pycon&quot;</span>

        main_page<span class="token punctuation">.</span>click_go_button<span class="token punctuation">(</span><span class="token punctuation">)</span>

        search_results_page <span class="token operator">=</span> page<span class="token punctuation">.</span>SearchResultsPage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>

        <span class="token comment">#Verifies that the results page is not empty</span>
        
        <span class="token comment"># 这是第二次测试，搜索结果页中是否有内容而不是&quot;No results found.&quot;</span>
        
        <span class="token keyword">assert</span> search_results_page<span class="token punctuation">.</span>is_results_found<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;No results found.&quot;</span>
        
    <span class="token keyword">def</span> <span class="token function">tearDown</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>

    unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#########</span>

<span class="token comment"># page.py</span>

<span class="token comment">#########</span>

<span class="token keyword">from</span> element <span class="token keyword">import</span> BasePageElement

<span class="token keyword">from</span> locators <span class="token keyword">import</span> MainPageLocators

<span class="token keyword">class</span> <span class="token class-name">SearchTextElement</span><span class="token punctuation">(</span>BasePageElement<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;This class gets the search text from the specified locator&quot;&quot;&quot;</span>

    <span class="token comment">#The locator for search box where search string is entered</span>

    <span class="token comment"># 搜索框的name是q</span>

    <span class="token comment"># &lt; input</span>

    <span class="token comment"># id = &quot;id-search-field&quot;</span>

    <span class="token comment"># name = &quot;q&quot;</span>

    <span class="token comment"># type = &quot;search&quot;</span>

    <span class="token comment"># role = &quot;textbox&quot;    #</span>

    <span class="token comment"># class =&quot;search-field&quot; placeholder=&quot;Search&quot; value=&quot;&quot; tabindex=&quot;1&quot; &gt;</span>

    locator <span class="token operator">=</span> <span class="token string">&#39;q&#39;</span>

<span class="token keyword">class</span> <span class="token class-name">BasePage</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;Base class to initialize the base page that will be called from all pages&quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> driver<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> driver

<span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>BasePage<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;Home page action methods come here. I.e. Python.org&quot;&quot;&quot;</span>

    <span class="token comment">#Declares a variable that will contain the retrieved text</span>

    search_text_element <span class="token operator">=</span> SearchTextElement<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">is_title_matches</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Verifies that the hardcoded text &quot;Python&quot; appears in page title&quot;&quot;&quot;</span>

        <span class="token keyword">return</span> <span class="token string">&quot;Python&quot;</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title

    <span class="token keyword">def</span> <span class="token function">click_go_button</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Triggers the search&quot;&quot;&quot;</span>
        
        element <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span><span class="token operator">*</span>MainPageLocators<span class="token punctuation">.</span>GO_BUTTON<span class="token punctuation">)</span>

        element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">SearchResultsPage</span><span class="token punctuation">(</span>BasePage<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;Search results page action methods come here&quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">is_results_found</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># Probably should search for this text in the specific page</span>

        <span class="token comment"># element, but as for now it works fine</span>

        <span class="token keyword">return</span> <span class="token string">&quot;No results found.&quot;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source

<span class="token comment">############</span>

<span class="token comment"># locator.py</span>

<span class="token comment">############</span>

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">class</span> <span class="token class-name">MainPageLocators</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;A class for main page locators. All main page locators should come here&quot;&quot;&quot;</span>

    GO_BUTTON <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&#39;submit&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">SearchResultsPageLocators</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;A class for search results locators. All search results locators should come here&quot;&quot;&quot;</span>

    <span class="token keyword">pass</span>

<span class="token comment">############</span>

<span class="token comment"># element.py</span>

<span class="token comment">############</span>

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait

<span class="token keyword">class</span> <span class="token class-name">BasePageElement</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;Base page class that is initialized on every page object class.&quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">__set__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Sets the text to the value supplied&quot;&quot;&quot;</span>

        driver <span class="token operator">=</span> obj<span class="token punctuation">.</span>driver

        WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>

            <span class="token keyword">lambda</span> driver<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> self<span class="token punctuation">.</span>locator<span class="token punctuation">)</span><span class="token punctuation">)</span>

        driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> self<span class="token punctuation">.</span>locator<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>value<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">,</span> owner<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Gets the text of the specified object&quot;&quot;&quot;</span>

        driver <span class="token operator">=</span> obj<span class="token punctuation">.</span>driver

        WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>

            <span class="token keyword">lambda</span> driver<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> self<span class="token punctuation">.</span>locator<span class="token punctuation">)</span><span class="token punctuation">)</span>

        element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> self<span class="token punctuation">.</span>locator<span class="token punctuation">)</span>

        <span class="token keyword">return</span> element<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="代码解读" tabindex="-1"><a class="header-anchor" href="#代码解读"><span>代码解读</span></a></h4><ol><li>在<code>setUp</code>方法中，编写的代码将启动Firefox浏览器并导航至python.org网站。</li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.python.org&quot;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这段代码中，<code>setUp</code>是一个特殊的测试方法，它在每个测试之前执行，用于设置测试环境。这里，使用<code>webdriver.Firefox()</code>创建了一个Firefox浏览器实例，并使用<code>get</code>方法打开了python.org网站。</p><ol start="2"><li>接下来的第一个测试案例旨在验证python.org主页的标题中包含单词&quot;Python&quot;。在这个测试用例中，我们首先创建了一个<code>MainPage</code>类的实例，然后使用<code>assert</code>语句来检查当前页面标题中是否包含单词&quot;Python&quot;。如果不包含，则测试将失败，并显示提供的错误消息。</li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
    <span class="token keyword">def</span> <span class="token function">test_search_in_python_org</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        main_page <span class="token operator">=</span> page<span class="token punctuation">.</span>MainPage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>

        <span class="token keyword">assert</span> main_page<span class="token punctuation">.</span>is_title_matches<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;python.org title doesn&#39;t match.&quot;</span>
        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>MainPage封装了主页中的和测试有关的对象和方法。</p><p>⑴ search_text_element：代表搜索框；</p><p>⑵ is_title_matches：用来判断当前打开网页的标题中是否含有python单词；</p><p>⑶click_go_button：用来点击搜索按钮。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">class</span> <span class="token class-name">MainPage</span><span class="token punctuation">(</span>BasePage<span class="token punctuation">)</span><span class="token punctuation">:</span>

    search_text_element <span class="token operator">=</span> SearchTextElement<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">is_title_matches</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Verifies that the hardcoded text &quot;Python&quot; appears in page title&quot;&quot;&quot;</span>

        <span class="token keyword">return</span> <span class="token string">&quot;Python&quot;</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title

    <span class="token keyword">def</span> <span class="token function">click_go_button</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Triggers the search&quot;&quot;&quot;</span>

        element <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&#39;submit&#39;</span><span class="token punctuation">)</span>

        element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>第二个测试案例是在搜索框中输入&quot;pycon&quot;，点击搜索按钮，并验证搜索结果页面确实显示了搜索结果（不是&quot;No results found.&quot;）。</li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
    <span class="token keyword">def</span> <span class="token function">test_search_in_python_org</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

        main_page<span class="token punctuation">.</span>search_text_element <span class="token operator">=</span> <span class="token string">&quot;pycon&quot;</span>

        main_page<span class="token punctuation">.</span>click_go_button<span class="token punctuation">(</span><span class="token punctuation">)</span>

        search_results_page <span class="token operator">=</span> page<span class="token punctuation">.</span>SearchResultsPage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>

        <span class="token keyword">assert</span> search_results_page<span class="token punctuation">.</span>is_results_found<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;No results found.&quot;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>搜索结果页也封装了和测试有关的方法is_result_found。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">class</span> <span class="token class-name">SearchResultsPage</span><span class="token punctuation">(</span>BasePage<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">is_results_found</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">return</span> <span class="token string">&quot;No results found.&quot;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>为了能直接对搜索框赋值，采用了如下代码：</li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
main_page<span class="token punctuation">.</span>search_text_element <span class="token operator">=</span> <span class="token string">&quot;pycon&quot;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在POM中，页面和页面元素都采用对象进行封装。search_text_element是SearchTextElement类的一个实例。</p><p>没有封装前，正常的做法是：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> <span class="token string">&#39;q&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">&quot;pycon&quot;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这段代码中有两个参数，一个是搜索框的NAME属性（&lt;input name=&#39;q&#39; ... &gt;），一个是搜索框中输入的值。所以，为了封装<code>driver.find_element(By.NAME, &#39;q&#39;).send_keys(&quot;pycon&quot;)</code> 操作，就需要封装这两个参数。</p><p>⑴ NAME属性封装在search_text_element对象（该对象是SearchTextElement类）的locator属性中：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">class</span> <span class="token class-name">SearchTextElement</span><span class="token punctuation">(</span>BasePageElement<span class="token punctuation">)</span><span class="token punctuation">:</span>

    locator <span class="token operator">=</span> <span class="token string">&#39;q&#39;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>⑵ 文本框中键入的值&quot;pycon&quot;出现在main_page.search_text_element = &quot;pycon&quot;赋值语句的右侧，表明search_text_element是一个描述符类。描述符是Python中的一个概念，它是一种特殊的类，通过实现<code>__set__</code>和<code>__get__</code>方法，可以控制对属性的设置和获取操作。描述符可以用作类的属性，以提供自定义的属性操作行为。</p><p>以下是BasePageElement类的实现。其中locator变量在其子类SearchTextElement中定义。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">class</span> <span class="token class-name">BasePageElement</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;Base page class that is initialized on every page object class.&quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">__set__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Sets the text to the value supplied&quot;&quot;&quot;</span>

        driver <span class="token operator">=</span> obj<span class="token punctuation">.</span>driver

        driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> self<span class="token punctuation">.</span>locator<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>value<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">,</span> owner<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Gets the text of the specified object&quot;&quot;&quot;</span>

        driver <span class="token operator">=</span> obj<span class="token punctuation">.</span>driver

        element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> self<span class="token punctuation">.</span>locator<span class="token punctuation">)</span>

        <span class="token keyword">return</span> element<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>补充说明：<code>main_page.search_text_element = &quot;pycon&quot;</code> 这里用了较多python的特性，其实要表达的意思就是以下代码。于是，类的封装究竟使得事情变得更加清晰还是更麻烦了呢？</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
main_page<span class="token punctuation">.</span>set_search_text<span class="token punctuation">(</span><span class="token string">&quot;pycon&quot;</span><span class="token punctuation">)</span>

main_page<span class="token punctuation">.</span>click_go_button<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>定位元素的方法也可以进行封装，原来的代码是<code>find_element(By.ID, &#39;submit&#39;)</code> 。</li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
    <span class="token keyword">def</span> <span class="token function">click_go_button</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token triple-quoted-string string">&quot;&quot;&quot;Triggers the search&quot;&quot;&quot;</span>

        element <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&#39;submit&#39;</span><span class="token punctuation">)</span>

        element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果将来要用别的查找定位方法，就可以将<code>(By.ID, &#39;submit&#39;)</code> 进行隔离。代码中利用了解包运算符（*）：<code>*MainPageLocators.GO_BUTTON</code> 。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># page.py</span>

<span class="token keyword">from</span> locators <span class="token keyword">import</span> MainPageLocators

    <span class="token keyword">def</span> <span class="token function">click_go_button</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        element <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span><span class="token operator">*</span>MainPageLocators<span class="token punctuation">.</span>GO_BUTTON<span class="token punctuation">)</span>

        element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># locators.py</span>

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">class</span> <span class="token class-name">MainPageLocators</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;A class for main page locators. All main page locators should come here&quot;&quot;&quot;</span>

    GO_BUTTON <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&#39;submit&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="七、pytest的使用" tabindex="-1"><a class="header-anchor" href="#七、pytest的使用"><span>七、pytest的使用</span></a></h2><p><code>pytest</code> 是一个非常流行的 Python 测试框架，它使得编写简单和可扩展的测试变得非常容易。下面是 <code>pytest</code> 的一些主要用法：</p><h3 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h3><p><strong>使用 pip 安装 pytest</strong>：在命令行中输入以下命令来安装 <code>pytest</code>：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
pip install pytest

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="基础用法" tabindex="-1"><a class="header-anchor" href="#基础用法"><span>基础用法</span></a></h3><ol><li><strong>测试文件和函数命名</strong>：</li></ol><ul><li><p>测试文件以 <code>test_</code> 开头（如 <code>test_example.py</code>）。</p></li><li><p>测试类以<code>Test</code>开头，不能以小写<code>test</code>开头，如<code>TestClass()</code>。</p></li><li><p>测试函数以 <code>test_</code> 开头（如 <code>def test_example():</code>）。</p></li></ul><p>2. <strong>运行测试</strong>：</p><ul><li><p>在命令行中，切换到包含测试文件的目录，然后运行 <code>pytest</code>。</p></li><li><p>也可以指定特定的测试文件，例如 <code>pytest test_example.py</code>。</p></li><li><p>您可以通过在命令行中指定函数的完整路径来运行单个测试函数。路径包括文件名、测试类名（如果有的话）和函数名，之间用双冒号 <code>::</code> 分隔。</p></li></ul><p>例如，假设您有一个名为 <code>test_module.py</code> 的文件，其中包含一个名为 <code>TestClass</code> 的测试类，该类中有一个名为 <code>test_method</code> 的测试函数。要运行这个特定的测试函数，您可以使用以下命令：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
pytest test_module.py::TestClass::test_method

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3. <strong>断言</strong>：</p><ul><li>使用内置的 <code>assert</code> 语句进行断言。</li></ul><h3 id="参数化测试" tabindex="-1"><a class="header-anchor" href="#参数化测试"><span>参数化测试</span></a></h3><ol><li><strong>参数化测试</strong></li></ol><ul><li>使用 <code>@pytest.mark.parametrize</code> 装饰器来参数化测试函数。</li></ul><p>参数化测试是 <code>pytest</code> 的一个强大特性，它允许你使用不同的参数多次运行同一个测试用例，而不需要写多个几乎相同的测试函数。这在测试输入和输出有多种可能性的场景中非常有用。</p><ol start="2"><li><strong>参数化测试的例子</strong></li></ol><p>下面是一个使用 <code>pytest.mark.parametrize</code> 进行参数化测试的例子：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
import pytest

# 这是一个简单的函数，用于演示参数化测试

def add(a, b):

    return a + b

# 使用 pytest.mark.parametrize 装饰器进行参数化

# &#39;test_data&#39; 是一个包含参数元组的列表，每个元组包含一组测试参数

# &#39;ids&#39; 是一个与 &#39;test_data&#39; 中每个参数元组对应的字符串标识符列表，用于在测试输出中标识每个测试用例

@pytest.mark.parametrize(&quot;a, b, expected&quot;, [

    (1, 2, 3),

    (-1, 1, 0),

    (0, 0, 0),

    (3.5, 2.5, 6.0),

], ids=[&quot;int positive&quot;, &quot;int negative&quot;, &quot;zero&quot;, &quot;floats&quot;])

def test_add(a, b, expected):

    assert add(a, b) == expected

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>test_add</code> 函数会被执行四次，每次使用 <code>test_data</code> 列表中的一个参数元组。<code>ids</code> 参数是可选的，它为每个测试用例提供了一个更易读的标识符，当测试执行时，这些标识符会显示在测试输出中，以便于识别每个测试用例。</p><p>当你运行这个测试模块时，<code>pytest</code> 会为每个参数组合生成一个测试用例，并在控制台输出每个测试用例的结果。如果所有断言都通过，测试就会成功；如果有任何断言失败，<code>pytest</code> 会提供有关失败的具体信息。</p><p>参数化测试不仅限于单个参数，你还可以传递多个参数，甚至是嵌套的参数组合。这使得 <code>pytest</code> 非常适合于编写数据驱动的测试。</p><ol start="3"><li><strong>参数化测试的例子（从CSV文件读取）</strong></li></ol><p>要结合从CSV文件读取记录和<code>pytest.mark.parametrize</code>进行测试，你首先需要有一个包含用户名和密码组合的CSV文件。然后，你可以在<code>pytest</code>测试中读取这个文件，并使用<code>parametrize</code>装饰器来参数化你的测试函数。</p><p>假设你有一个名为<code>users.csv</code>的CSV文件，内容如下：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
username,password

user1,pwd1

user2,pwd2

user3,pwd3

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面是一个使用<code>pytest.mark.parametrize</code>和从CSV文件读取数据的测试例子：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">import</span> csv

<span class="token keyword">import</span> pytest

<span class="token comment"># 假设这是一个用于验证用户名和密码的函数</span>

<span class="token keyword">def</span> <span class="token function">validate_user</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 这里应该有真实的用户验证逻辑</span>

    <span class="token keyword">return</span> username <span class="token operator">==</span> <span class="token string">&quot;user2&quot;</span> <span class="token keyword">and</span> password <span class="token operator">==</span> <span class="token string">&quot;pwd2&quot;</span>

<span class="token comment"># 读取CSV文件并返回一个包含用户名和密码的列表</span>

<span class="token keyword">def</span> <span class="token function">read_users_from_csv</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>

    users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>

        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictReader<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>

        <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>

            users<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            
    <span class="token keyword">return</span> users

<span class="token comment"># 使用 parametrize 从 CSV 文件中读取用户名和密码组合</span>

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span><span class="token string">&quot;username, password&quot;</span><span class="token punctuation">,</span> read_users_from_csv<span class="token punctuation">(</span><span class="token string">&#39;users.csv&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_validate_user</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">assert</span> validate_user<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> <span class="token string">&quot;user2&quot;</span> <span class="token keyword">and</span> password <span class="token operator">==</span> <span class="token string">&quot;pwd2&quot;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>read_users_from_csv</code>函数打开并读取CSV文件，然后解析其中的内容，返回一个包含用户名和密码元组的列表。<code>pytest.mark.parametrize</code>装饰器使用这个列表来参数化<code>test_validate_user</code>函数，使得每个用户名和密码组合都会被用来调用这个测试函数。</p><p>请注意，这个例子中的<code>validate_user</code>函数是一个示例函数，你需要根据实际的用户验证逻辑来编写这个函数。同样，<code>test_validate_user</code>函数的断言也应该根据你的实际验证逻辑来编写。</p><p>确保CSV文件和测试脚本位于同一目录中，或者提供正确的文件路径给<code>read_users_from_csv</code>函数。当运行<code>pytest</code>时，它会自动发现并执行参数化的测试用例。</p><h3 id="设置和清理测试环境" tabindex="-1"><a class="header-anchor" href="#设置和清理测试环境"><span>设置和清理测试环境</span></a></h3><h4 id="方法一-使用-setup-class-setup-method-等传统方法" tabindex="-1"><a class="header-anchor" href="#方法一-使用-setup-class-setup-method-等传统方法"><span>方法一：使用 <code>setup_class</code>/<code>setup_method</code> 等传统方法</span></a></h4><p>在pytest中，<code>setup</code>和<code>teardown</code>方法用于在测试函数或类之前和之后进行一些初始化和清理工作。以下是一些常用的<code>setup</code>和<code>teardown</code>方法：</p><ol><li><code>setup_module</code>和<code>teardown_module</code>：这两个方法在整个模块的开始和结束时运行一次。</li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">def</span> <span class="token function">setup_module</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">teardown_module</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">pass</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><code>setup_function</code>和<code>teardown_function</code>：这两个方法在每个测试函数（不在类中）的开始和结束时运行。</li></ol><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
def setup_function(function):

    pass

def teardown_function(function):

    pass

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><code>setup_class</code>和<code>teardown_class</code>：这两个方法在每个测试类的开始和结束时运行一次。</li></ol><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
@classmethod

def setup_class(cls):

    pass

@classmethod

def teardown_class(cls):

    pass

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><code>setup_method</code>和<code>teardown_method</code>：这两个方法在每个测试方法（在类中）的开始和结束时运行。</li></ol><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
def setup_method(self, method):

    pass

def teardown_method(self, method):

    pass

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li><code>setup</code>和<code>teardown</code>：这两个方法在每个测试函数的开始和结束时运行，与<code>setup_function</code>和<code>teardown_function</code>类似。</li></ol><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
def setup(self):

    pass

def teardown(self):

    pass

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="方法一使用示例-使用-setup-class-setup-method-等传统方法" tabindex="-1"><a class="header-anchor" href="#方法一使用示例-使用-setup-class-setup-method-等传统方法"><span>方法一使用示例：使用 <code>setup_class</code>/<code>setup_method</code> 等传统方法</span></a></h4><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># 文件名： test_module.py</span>

<span class="token keyword">import</span> pytest

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">def</span> <span class="token function">setup_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;模块级别的 setup&#39;</span><span class="token punctuation">)</span>

    <span class="token comment"># 这里准备测试所需的资源</span>

<span class="token keyword">def</span> <span class="token function">teardown_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;模块级别的 teardown&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">setup_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;函数级别的 setup&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">teardown_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;函数级别的 teardown&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">setup_method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;方法级别的 setup&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">teardown_method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;方法级别的 teardown&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;执行测试前&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># 测试代码</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;执行测试后&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_another</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;另一个测试前&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># 另一个测试代码</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;另一个测试后&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>

    pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;-s&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在控制台下输入<code>python test_module.py</code>，程序运行后的输出结果为：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
模块级别的 setup

函数级别的 setup

执行测试前

执行测试后

<span class="token punctuation">.</span>函数级别的 teardown

函数级别的 setup

另一个测试前

另一个测试后

<span class="token punctuation">.</span>函数级别的 teardown

模块级别的 teardown

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果您在运行时发现代码中的 <code>print</code> 语句没有输出，这可能是由于以下几个原因：</p><ol><li><strong>默认输出重定向</strong>：<code>pytest</code> 默认会将输出重定向到缓冲区，而不是直接输出到控制台。这是为了确保测试结果的清晰和有序。如果您想要看到 <code>print</code> 语句的输出，可以使用 <code>-s</code> 或 <code>--capture=no</code> 选项来禁用这种输出重定向。</li></ol><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>pytest -s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>测试失败时的输出</strong>：如果测试失败，<code>pytest</code> 通常会显示相关的输出，包括 <code>print</code> 语句的输出。如果测试通过了，<code>pytest</code> 不会显示这些输出，除非使用了 <code>-s</code> 选项。</li></ul><h4 id="方法二-使用-pytest-fixture-装饰器" tabindex="-1"><a class="header-anchor" href="#方法二-使用-pytest-fixture-装饰器"><span>方法二：使用 <code>@pytest.fixture()</code> 装饰器</span></a></h4><p>在pytest中，还可以使用<code>pytest.fixture()</code>装饰器来创建自定义的<code>setup</code>和<code>teardown</code>方法。这种方法更加灵活和强大，可以控制多个测试函数之间的共享数据和行为。</p><p>例如，使用<code>pytest.fixture()</code>创建一个自定义的<code>setup</code>和<code>teardown</code>方法：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
import pytest

@pytest.fixture(scope=&#39;module&#39;)

def my_fixture():

    print(&#39;Setup&#39;)

    yield 

    print(&#39;Teardown&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在测试函数中，可以通过参数传递来使用这个自定义的<code>fixture</code>：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
def test_example(my_fixture):

    print(&#39;Test&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>全局 setup 和 teardown</li></ol><p>如果你想要在所有测试开始之前和结束之后执行一些操作，可以在 <code>conftest.py</code> 文件中定义一个 session 级别的 fixture：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
# conftest.py

import pytest

@pytest.fixture(scope=&#39;session&#39;, autouse=True)

def setup_and_teardown_session():

    print(&#39;### Setup session ###&#39;)

    yield

    print(&#39;### Teardown session ###&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>模块级别的 setup 和 teardown</li></ol><p>在 <code>pytest</code> 中，模块级别的 <code>setup</code> 和 <code>teardown</code> 可以通过定义一个模块级别的 fixture 来实现：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
# test_module.py

import pytest

@pytest.fixture(scope=&#39;module&#39;, autouse=True)

def setup_and_teardown_module():

    print(&#39;### Setup module ###&#39;)

    yield

    print(&#39;### Teardown module ###&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>类级别的 setup 和 teardown</li></ol><p>对于类级别的 <code>setup</code> 和 <code>teardown</code>，可以使用 <code>class</code> 级别的 fixture：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
# test_class.py

import pytest

@pytest.fixture(scope=&#39;class&#39;, autouse=True)

def setup_and_teardown_class(request):

    print(&#39;### Setup class ###&#39;)

    yield

    print(&#39;### Teardown class ###&#39;)

@pytest.mark.usefixtures(&#39;setup_and_teardown_class&#39;)

class TestClass:

    def test_method1(self):

        pass

    def test_method2(self):

        pass
        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>方法级别的 setup 和 teardown</li></ol><p>方法级别的 <code>setup</code> 和 <code>teardown</code> 可以通过定义一个函数级别的 fixture 来实现：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># test_function.py</span>

<span class="token keyword">import</span> pytest

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>autouse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">setup_and_teardown_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;### Setup function ###&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">yield</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;### Teardown function ###&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_function1</span><span class="token punctuation">(</span>setup_and_teardown_function<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">test_function2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">pass</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在上述示例中，<code>yield</code> 关键字之前的代码相当于 <code>setup</code>，而 <code>yield</code> 关键字之后的代码相当于 <code>teardown</code>。<code>scope</code> 参数用于指定 fixture 的作用范围，<code>autouse=True</code> 参数表示自动应用该 fixture，无需在每个测试函数中显式地声明。</p><p><code>pytest</code> 的 fixture 机制比 <code>unittest</code> 的 <code>setup</code> 和 <code>teardown</code> 更加灵活和强大，因为它允许你创建可重用的测试环境，并且可以跨多个测试或测试类共享。</p><h4 id="方法二使用示例-使用-pytest-fixture-装饰器" tabindex="-1"><a class="header-anchor" href="#方法二使用示例-使用-pytest-fixture-装饰器"><span>方法二使用示例：使用 <code>@pytest.fixture()</code> 装饰器</span></a></h4><p>在 <code>pytest</code> 中，fixture 的 setup 和 teardown 特性是通过在 fixture 函数中使用 <code>yield</code> 关键字来实现的。<code>yield</code> 之前的代码是 setup 部分，<code>yield</code> 之后的代码是 teardown 部分。下面是一个示例，它展示了如何在测试前后执行特定操作：</p><p>python</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
import pytest

@pytest.fixture

def supply_AA_BB_CC():

    print(&quot;Setup: Initializing values&quot;)

    aa = 25

    bb = 35

    cc = 45

    yield [aa, bb, cc]

    print(&quot;Teardown: Cleaning up resources&quot;)

def test_compare(supply_AA_BB_CC):

    aa, bb, cc = supply_AA_BB_CC

    print(&quot;Test: Comparing values&quot;)

    assert aa &lt; bb

    assert bb &lt; cc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个示例中，<code>supply_AA_BB_CC</code> fixture 在 setup 阶段初始化了三个数值 <code>aa</code>、<code>bb</code> 和 <code>cc</code>，并打印了一条消息。然后，它通过 <code>yield</code> 关键字返回这些数值。在 teardown 阶段，它打印了另一条消息，表示清理资源的操作。请注意，teardown 阶段的代码将在测试函数完成后执行，即使测试函数失败或产生异常。</p><p>当您运行这个测试时，输出将类似于：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
Setup: Initializing values

Test: Comparing values

Teardown: Cleaning up resources

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样，您就可以确保在测试前后执行特定的操作，例如设置测试环境、初始化资源、清理临时文件等。使用 <code>yield</code> 的好处是它可以确保 teardown 逻辑始终被执行，即使测试本身失败或产生异常。</p><h4 id="两种方法的总结" tabindex="-1"><a class="header-anchor" href="#两种方法的总结"><span>两种方法的总结</span></a></h4><p><code>pytest</code> 提供了两种不同的方式来设置和清理测试环境：使用 <code>@pytest.fixture()</code> 装饰器和使用 <code>setup_class</code>/<code>setup_method</code> 等传统的类方法。这两套做法的存在主要是为了兼容性和灵活性。</p><p><strong>@pytest.fixture()</strong>** 装饰器**：</p><ul><li><p><code>@pytest.fixture()</code> 是 <code>pytest</code> 中设置和清理测试环境的首选方式。它提供了高度的灵活性和强大的功能，如参数化、范围控制（函数级、类级、模块级、会话级）、自动执行和依赖注入。</p></li><li><p>Fixtures 可以定义为函数或类方法，可以返回数据，也可以 yield 数据，后者允许你在 fixture 中执行清理代码。</p></li><li><p>Fixtures 可以被其他 fixtures 或测试用例作为参数使用，这使得它们非常适用于提供共享资源和配置。</p></li></ul><p><strong>setup_class</strong>**/<strong><strong>setup_method</strong></strong> 等类方法**：</p><ul><li><p>这些方法借鉴了传统的单元测试框架（如 <code>unittest</code>）的命名约定，用于在类级别的测试中执行设置和清理操作。</p></li><li><p><code>setup_class</code> 是一个类方法（<code>@classmethod</code>），它在执行类中的任何测试方法之前执行一次。</p></li><li><p><code>setup_method</code>（在 <code>pytest</code> 中通常称为 <code>setup</code>）是一个实例方法，它在每个测试方法之前执行。</p></li><li><p>这些方法的主要优点是它们对于从其他测试框架（如 <code>unittest</code>）迁移到 <code>pytest</code> 的用户来说很熟悉。</p></li></ul><p><code>pytest</code> 支持 <code>setup_class</code>/<code>setup_method</code> 等方法的主要原因是兼容性和易于迁移。许多开发者可能已经习惯了这些传统的命名和用法，因此 <code>pytest</code> 提供了这种兼容性，使得从其他框架迁移变得更加容易。</p><p>然而，随着时间的推移，<code>pytest</code> 社区更倾向于使用 <code>@pytest.fixture()</code> 装饰器，因为它提供了更多的控制和灵活性。Fixtures 可以更精细地管理测试环境，支持复杂的测试场景，并提供更好的测试代码组织。</p><p>总之，尽管两套做法都可用，但推荐使用 <code>@pytest.fixture()</code> 装饰器来设置和清理测试环境，因为它更加现代、灵活，并且是 <code>pytest</code> 的核心特性之一。</p><h4 id="常见问题" tabindex="-1"><a class="header-anchor" href="#常见问题"><span>常见问题</span></a></h4><h5 id="问题1-模块级别和方法级别的setup和teardown有什么区别" tabindex="-1"><a class="header-anchor" href="#问题1-模块级别和方法级别的setup和teardown有什么区别"><span>问题1：模块级别和方法级别的setup和teardown有什么区别？</span></a></h5><p>在 <code>pytest</code> 中，模块级别和方法级别的 setup 和 teardown 主要区别在于它们的执行范围和作用域。模块级别的 setup 和 teardown 在整个测试模块的开始和结束时执行一次，而方法级别的 setup 和 teardown 对每个测试函数都会执行一次。选择哪种级别的 setup 和 teardown 取决于你的测试需求和测试环境的要求。</p><p><strong>模块级别的 setup 和 teardown</strong></p><p>模块级别的 setup 和 teardown 在每个测试模块（即每个 <code>.py</code> 文件）开始和结束时执行一次。这意味着不管模块中有多少个测试函数或测试类，模块级别的 setup 和 teardown 只会执行一次。</p><p>在 <code>pytest</code> 中，你可以使用 <code>module</code> 级别的 fixture 来实现模块级别的 setup 和 teardown：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># test_module.py</span>

<span class="token keyword">import</span> pytest

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>scope<span class="token operator">=</span><span class="token string">&#39;module&#39;</span><span class="token punctuation">,</span> autouse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">module_setup_teardown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;### Setup module ###&#39;</span><span class="token punctuation">)</span>

    <span class="token comment"># 执行模块级别的 setup</span>

    <span class="token keyword">yield</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;### Teardown module ###&#39;</span><span class="token punctuation">)</span>

    <span class="token comment"># 执行模块级别的 teardown</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>module_setup_teardown</code> fixture 被标记为 <code>scope=&#39;module&#39;</code>，这意味着它的 setup 部分会在模块中的第一个测试开始之前执行，而它的 teardown 部分会在模块中的所有测试完成后执行。</p><p><strong>方法级别的 setup 和 teardown</strong></p><p>方法级别的 setup 和 teardown 对每个测试函数（即每个以 <code>test_</code> 开头的函数）都会执行一次。这意味着如果有多个测试函数，每个测试函数之前都会执行 setup，之后都会执行 teardown。</p><p>在 <code>pytest</code> 中，函数级别的 fixture 可以用来实现方法级别的 setup 和 teardown：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment"># test_function.py</span>

<span class="token keyword">import</span> pytest

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>autouse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">function_setup_teardown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;### Setup function ###&#39;</span><span class="token punctuation">)</span>

    <span class="token comment"># 执行方法级别的 setup</span>

    <span class="token keyword">yield</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;### Teardown function ###&#39;</span><span class="token punctuation">)</span>

    <span class="token comment"># 执行方法级别的 teardown</span>

<span class="token keyword">def</span> <span class="token function">test_function1</span><span class="token punctuation">(</span>function_setup_teardown<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Running test_function1&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_function2</span><span class="token punctuation">(</span>function_setup_teardown<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Running test_function2&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>function_setup_teardown</code> fixture 没有指定 <code>scope</code> 参数，默认为 <code>function</code> 级别，这意味着它的 setup 部分会在每个测试函数开始之前执行，而它的 teardown 部分会在每个测试函数完成后执行。</p><h5 id="问题2-如果我的测试函数是封装在类中的-那么pytest会运行这些函数吗" tabindex="-1"><a class="header-anchor" href="#问题2-如果我的测试函数是封装在类中的-那么pytest会运行这些函数吗"><span>问题2：如果我的测试函数是封装在类中的，那么pytest会运行这些函数吗？</span></a></h5><p>是的，<code>pytest</code> 会运行封装在类中的测试函数。在 <code>pytest</code> 中，你可以将测试函数定义为类的方法，这些类称为测试类。测试类中的方法必须以 <code>test_</code> 开头，这样 <code>pytest</code> 才能识别它们为测试用例。</p><p>下面是一个使用测试类的示例：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">import</span> pytest

<span class="token keyword">class</span> <span class="token class-name">TestExample</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">test_method1</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">assert</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">test_method2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">assert</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">2</span>
        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>TestExample</code> 类包含了两个测试方法 <code>test_method1</code> 和 <code>test_method2</code>。<code>pytest</code> 会自动检测这些方法并运行它们。</p><p>你也可以在测试类中使用 fixtures，通过将它们作为参数传递给测试方法：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">import</span> pytest

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span>

<span class="token keyword">def</span> <span class="token function">supply_AA_BB_CC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    aa <span class="token operator">=</span> <span class="token number">25</span>

    bb <span class="token operator">=</span> <span class="token number">35</span>

    cc <span class="token operator">=</span> <span class="token number">45</span>

    <span class="token keyword">return</span> <span class="token punctuation">[</span>aa<span class="token punctuation">,</span> bb<span class="token punctuation">,</span> cc<span class="token punctuation">]</span>

<span class="token keyword">class</span> <span class="token class-name">TestComparisons</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">test_compare</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> supply_AA_BB_CC<span class="token punctuation">)</span><span class="token punctuation">:</span>

        aa<span class="token punctuation">,</span> bb<span class="token punctuation">,</span> cc <span class="token operator">=</span> supply_AA_BB_CC

        <span class="token keyword">assert</span> aa <span class="token operator">&lt;</span> bb

        <span class="token keyword">assert</span> bb <span class="token operator">&lt;</span> cc

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>supply_AA_BB_CC</code> fixture 被用于 <code>TestComparisons</code> 类中的 <code>test_compare</code> 方法。<code>pytest</code> 会自动调用 fixture 并将其返回的值传递给测试方法。</p><p><strong>测试类还可以有 setup 和 teardown 方法</strong>，这些方法在每个测试方法执行前后会被调用。你可以使用 <code>@classmethod</code> 装饰器来定义类级别的 setup 和 teardown 方法，或者**使用 <strong><strong>setup_method</strong></strong> 和 **<strong>teardown_method</strong>（或者 <code>setUp</code> 和 <code>tearDown</code>，与 <code>unittest</code> 兼容）来定义方法级别的 setup 和 teardown：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">import</span> pytest

<span class="token keyword">class</span> <span class="token class-name">TestExample</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    
    <span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup class&quot;</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@classmethod</span>

    <span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Teardown class&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">setup_method</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Setup method&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">teardown_method</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Teardown method&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_method1</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Running test_method1&quot;</span><span class="token punctuation">)</span>

        <span class="token keyword">assert</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">test_method2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Running test_method2&quot;</span><span class="token punctuation">)</span>

        <span class="token keyword">assert</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">2</span>
        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>setup_class</code> 和 <code>teardown_class</code> 分别在类中的所有测试方法执行前后各运行一次，而 <code>setup_method</code> 和 <code>teardown_method</code> 则在每个测试方法执行前后各运行一次。</p><h5 id="问题3-如何建立fixture的依赖关系" tabindex="-1"><a class="header-anchor" href="#问题3-如何建立fixture的依赖关系"><span>问题3：如何建立fixture的依赖关系？</span></a></h5><p>在pytest中，指定fixture的依赖关系非常简单。你只需要在fixture函数中将其依赖的其他fixture作为参数传入即可。pytest会自动处理这些依赖关系，确保在需要时按顺序执行它们。</p><p>下面是一个简单的例子，展示了如何指定fixture之间的依赖关系：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
import pytest

@pytest.fixture

def fixture_A():

    print(&quot;Setup A&quot;)

    yield

    print(&quot;Teardown A&quot;)

@pytest.fixture

def fixture_B(fixture_A):

    print(&quot;Setup B&quot;)

    yield

    print(&quot;Teardown B&quot;)

@pytest.fixture

def fixture_C(fixture_B):

    print(&quot;Setup C&quot;)

    yield

    print(&quot;Teardown C&quot;)

def test_example(fixture_C):

    print(&quot;Running test&quot;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>fixture_B</code>依赖于<code>fixture_A</code>，而<code>fixture_C</code>依赖于<code>fixture_B</code>。当<code>test_example</code>运行时，pytest会按照以下顺序执行fixtures：</p><ol><li><p><code>fixture_A</code>的setup</p></li><li><p><code>fixture_B</code>的setup（依赖于<code>fixture_A</code>）</p></li><li><p><code>fixture_C</code>的setup（依赖于<code>fixture_B</code>）</p></li><li><p>执行测试函数<code>test_example</code></p></li><li><p><code>fixture_C</code>的teardown</p></li><li><p><code>fixture_B</code>的teardown</p></li><li><p><code>fixture_A</code>的teardown</p></li></ol><p>通过这种方式，你可以创建一个fixture链，其中每个fixture都可以依赖于前一个fixture。这使得设置测试环境变得更加灵活和模块化。如果你想要改变fixture的执行顺序，只需要调整fixture参数的顺序即可。</p><h4 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h4><ol start="4"><li><strong>插件</strong>：</li></ol><ul><li><code>pytest</code> 有大量的插件，可以用来做各种各样的事情，例如测试覆盖率（<code>pytest-cov</code>），并行测试（<code>pytest-xdist</code>）等。</li></ul><ol start="5"><li><strong>钩子函数</strong>：</li></ol><ul><li><code>pytest</code> 提供了钩子函数，允许用户自定义测试的行为。</li></ul><h2 id="八、日志记录的标准库——logging" tabindex="-1"><a class="header-anchor" href="#八、日志记录的标准库——logging"><span>八、日志记录的标准库——logging</span></a></h2><p>在Python中，<code>logging</code>模块是一个用于日志记录的标准库，它提供了灵活的日志记录系统。<code>Logger</code>是该模块中的一个核心组件，用于暴露记录日志的方法。下面将详细介绍<code>Logger</code>的用法。</p><h3 id="基础用法-1" tabindex="-1"><a class="header-anchor" href="#基础用法-1"><span>基础用法</span></a></h3><ol><li><strong>导入模块</strong></li></ol><p>首先，你需要导入<code>logging</code>模块。</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
import logging

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>获取Logger对象</strong></p><p>使用<code>logging.getLogger(name)</code>来获取一个<code>Logger</code>对象，其中<code>name</code>是日志器的名称，用于标识不同的日志器。</p><p>python</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
logger = logging.getLogger(&#39;example_logger&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>设置日志级别</strong></p><p>日志器有多个日志级别，例如：DEBUG、INFO、WARNING、ERROR和CRITICAL。你可以通过<code>setLevel()</code>方法设置日志器的级别。</p><p>python</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
logger.setLevel(logging.INFO)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>添加Handler</strong></p><p><code>Handler</code>负责将日志消息发送到指定的目的地。你需要添加至少一个<code>Handler</code>到<code>Logger</code>。</p><p>python</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
handler = logging.StreamHandler()

logger.addHandler(handler)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>设置Handler的日志级别</strong></p><p>同样，<code>Handler</code>也有日志级别，用于过滤消息。</p><p>python</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
handler.setLevel(logging.INFO)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>添加Formatter</strong></p><p><code>Formatter</code>用于指定日志记录的格式。</p><p>python</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
formatter = logging.Formatter(&#39;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#39;)

handler.setFormatter(formatter)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>记录日志</strong></p><p>最后，你可以使用<code>Logger</code>对象的多种方法记录日志。</p><p>python</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
logger.debug(&#39;This is a debug message&#39;)

logger.info(&#39;This is an info message&#39;)

logger.warning(&#39;This is a warning message&#39;)

logger.error(&#39;This is an error message&#39;)

logger.critical(&#39;This is a critical message&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="进阶用法" tabindex="-1"><a class="header-anchor" href="#进阶用法"><span>进阶用法</span></a></h3><ul><li><strong>使用多个Logger</strong></li></ul><p>你可以创建多个<code>Logger</code>对象，每个对象可以有不同的名称和设置。</p><ul><li><strong>使用多个Handler</strong></li></ul><p>你可以将多个<code>Handler</code>添加到同一个<code>Logger</code>，实现日志的多目的地输出。</p><p>在Python的<code>logging</code>模块中，<code>Handler</code>是一个重要的组件，它负责将日志消息发送到指定的目的地。每个<code>Handler</code>可以指定自己的日志级别，并且可以有自己的<code>Formatter</code>来定义日志的格式。</p><p>为什么需要<code>Handler</code>呢？原因有以下几点：</p><ol><li><p><strong>多目的地输出</strong>：你可以将日志输出到多个目的地，例如控制台、文件、网络等。每个目的地都可以通过一个<code>Handler</code>来管理。</p></li><li><p><strong>灵活的日志管理</strong>：通过添加或删除<code>Handler</code>，你可以轻松地改变日志的输出位置和方式，而不需要修改应用程序的其它部分。</p></li><li><p><strong>分级控制</strong>：每个<code>Handler</code>可以设置自己的日志级别，这样你就可以对不同目的地应用不同的过滤规则。</p></li><li><p><strong>日志分发</strong>：<code>Logger</code>对象会将其日志消息分发给所有关联的<code>Handler</code>，这样你只需要在一个地方记录日志，就可以同时在多个地方看到。</p></li><li><p><strong>异步处理</strong>：某些<code>Handler</code>支持异步记录日志，这意味着日志记录不会阻塞应用程序的主线程，从而提高性能。</p></li></ol><p>例如，如果你想将日志同时输出到控制台和文件，你可以创建两个<code>Handler</code>，一个用于控制台输出（<code>StreamHandler</code>），另一个用于文件输出（<code>FileHandler</code>）：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">import</span> logging

<span class="token comment"># 创建Logger</span>

logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token string">&#39;example_logger&#39;</span><span class="token punctuation">)</span>

logger<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>

<span class="token comment"># 创建Handler</span>

console_handler <span class="token operator">=</span> logging<span class="token punctuation">.</span>StreamHandler<span class="token punctuation">(</span><span class="token punctuation">)</span>

file_handler <span class="token operator">=</span> logging<span class="token punctuation">.</span>FileHandler<span class="token punctuation">(</span><span class="token string">&#39;example.log&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># 设置Handler的日志级别</span>

console_handler<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>

file_handler<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>ERROR<span class="token punctuation">)</span>

<span class="token comment"># 创建Formatter</span>

formatter <span class="token operator">=</span> logging<span class="token punctuation">.</span>Formatter<span class="token punctuation">(</span><span class="token string">&#39;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># 为Handler设置Formatter</span>

console_handler<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>formatter<span class="token punctuation">)</span>

file_handler<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>formatter<span class="token punctuation">)</span>

<span class="token comment"># 将Handler添加到Logger</span>

logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>console_handler<span class="token punctuation">)</span>

logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>file_handler<span class="token punctuation">)</span>

<span class="token comment"># 记录日志</span>

logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&#39;This message will go to console and file&#39;</span><span class="token punctuation">)</span>

logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">&#39;This error message will go to console and file&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，所有的<code>INFO</code>及以上级别的日志都会输出到控制台，而<code>ERROR</code>及以上的日志会同时输出到控制台和文件。通过这种方式，你可以根据需要灵活地配置日志的输出。</p><ul><li><strong>继承日志级别</strong></li></ul><p>如果没有为<code>Logger</code>设置级别，它会继承最近的祖先<code>Logger</code>的级别。</p><ul><li><strong>配置文件</strong></li></ul><p>你可以通过配置文件来设置<code>Logger</code>、<code>Handler</code>、<code>Formatter</code>等，这样不需要在代码中硬编码。</p><h3 id="完整示例" tabindex="-1"><a class="header-anchor" href="#完整示例"><span>完整示例</span></a></h3><p>python</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
import logging

# 创建Logger

logger = logging.getLogger(&#39;example_logger&#39;)

logger.setLevel(logging.INFO)

# 创建Handler

console_handler = logging.StreamHandler()

console_handler.setLevel(logging.INFO)

# 创建Formatter

formatter = logging.Formatter(&#39;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#39;)

console_handler.setFormatter(formatter)

# 添加Handler到Logger

logger.addHandler(console_handler)

# 记录日志

logger.info(&#39;This is an info message&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个示例将日志输出到控制台，你可以根据需要添加其他<code>Handler</code>以实现不同的日志输出方式。</p><h3 id="附录-formatter类" tabindex="-1"><a class="header-anchor" href="#附录-formatter类"><span>附录：Formatter类</span></a></h3><p>在Python的<code>logging</code>模块中，<code>Formatter</code>类用于指定日志记录的格式。当创建一个<code>Formatter</code>实例时，你需要提供一个格式字符串，这个字符串包含了一些预定义的格式化字段，这些字段会在日志记录被创建时被替换为相应的值。</p><p>在你的例子中：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>
formatter = logging.Formatter(&#39;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个格式化字符串包含以下字段：</p><ul><li><p><code>%(asctime)s</code>：日志记录的时间。<code>asctime</code>是日志记录事件的时间戳，格式化为一个可读的字符串。默认格式是<code>&quot;%Y-%m-%d %H:%M:%S,uuu&quot;</code>，其中<code>uuu</code>是微秒部分。</p></li><li><p><code>%(name)s</code>：记录日志的<code>Logger</code>的名称。</p></li><li><p><code>%(levelname)s</code>：日志记录的级别名称（如<code>&quot;DEBUG&quot;</code>、<code>&quot;INFO&quot;</code>、<code>&quot;WARNING&quot;</code>、<code>&quot;ERROR&quot;</code>、<code>&quot;CRITICAL&quot;</code>）。</p></li><li><p><code>%(message)s</code>：日志记录的消息本身，也就是<code>Logger</code>的<code>info()</code>、<code>debug()</code>、<code>warning()</code>、<code>error()</code>等方法中提供的文本。</p></li></ul><p>当你将这个<code>Formatter</code>实例应用到<code>Handler</code>上时，<code>Handler</code>会将每个日志记录按照这个格式进行格式化，然后输出到相应的目的地（例如控制台或文件）。这样，每条日志都会按照你定义的格式来显示时间、日志器名称、日志级别和日志消息。</p><p><code>Formatter</code>的格式字符串中的<code>%</code>是一个格式化占位符，它用于在字符串中插入变量的值。在<code>%</code>后面紧跟着的字符表示要插入的变量的类型。例如，<code>s</code>表示字符串（<code>str</code>类型）。</p><p>当你看到<code>%(name)s</code>这样的占位符时，<code>name</code>是一个键，它告诉<code>logging</code>模块要插入哪个变量的值。<code>s</code>表示这个变量的值应该被格式化为一个字符串。</p><p>这里的<code>name</code>是对应于日志记录器名称的键，<code>logging</code>模块会用实际的日志记录器名称替换这个占位符。例如，如果你的日志记录器名称是<code>&quot;my_logger&quot;</code>，那么<code>%(name)s</code>会被替换为字符串<code>&quot;my_logger&quot;</code>。</p><p>在<code>logging</code>模块的格式字符串中，常用的占位符和它们的含义包括：</p><ul><li><p><code>%s</code>：字符串</p></li><li><p><code>%d</code>：整数（<code>int</code>类型）</p></li><li><p><code>%f</code>：浮点数（<code>float</code>类型）</p></li><li><p><code>%r</code>：字符串，使用<code>repr()</code>而不是<code>str()</code>来转换变量</p></li><li><p><code>%()</code>：使用<code>str.format()</code>风格的格式化</p></li></ul><p>因此，<code>%(name)s</code>中的<code>s</code>只是指明<code>name</code>变量的值应该被格式化为一个字符串。在<code>logging</code>的上下文中，这是最常见的用法，因为大多数日志记录的组件（如时间、日志器名称、日志级别等）都是字符串类型的。</p><h2 id="九、使用allure产生测试结果报告" tabindex="-1"><a class="header-anchor" href="#九、使用allure产生测试结果报告"><span>九、使用allure产生测试结果报告</span></a></h2><h3 id="allure的安装和使用" tabindex="-1"><a class="header-anchor" href="#allure的安装和使用"><span>Allure的安装和使用</span></a></h3><p><code>Allure</code> 是一个灵活的、轻量级的测试报告工具，它提供了丰富的插件和详细的测试结果。它支持多种测试框架，包括 <code>pytest</code>、<code>JUnit</code>、<code>TestNG</code> 等。以下是一些 <code>Allure</code> 的常见用法：</p><p><strong>安装 Allure</strong>：</p><ul><li>使用 <code>pip</code> 安装 Allure-Pytest 插件：</li></ul><p>bash</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>pip install allure-pytest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>生成 Allure 报告</strong>：</p><ul><li>在 <code>pytest</code> 测试中添加 <code>--alluredir</code> 选项来生成 Allure 报告：</li></ul><p>bash</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>pytest --alluredir=/path/to/allure-results
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>查看 Allure 报告</strong>：</p><p><code>allure</code> 命令来自于 Allure Framework 的命令行工具。这个工具允许你生成、查看和清理测试报告。要使用 <code>allure</code> 命令，<strong>你需要在你的系统上安装 Allure Framework。</strong></p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code>https://github.com/allure-framework/allure2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>使用 <code>allure serve</code> 命令来查看生成的报告：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>allure serve /path/to/allure-results
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>这将启动一个本地服务器，并自动打开浏览器显示报告。</li></ul><p><strong>添加附件</strong>：</p><ul><li>在测试中添加附件，例如截图或日志文件：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>allure.attach.file(&#39;/path/to/image.png&#39;, &#39;Image&#39;, attachment_type=allure.attachment_type.PNG)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>标记测试用例</strong>：</p><ul><li>使用 <code>@allure.feature</code>、<code>@allure.story</code>、<code>@allure.severity</code> 等装饰器来标记测试用例：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>@allure.feature(&#39;Login&#39;)

@allure.story(&#39;Login with valid credentials&#39;)

@allure.severity(allure.severity_level.CRITICAL)

def test_login_with_valid_credentials():

    # 测试代码
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>步骤日志</strong>：</p><ul><li>使用 <code>allure.step</code> 来记录测试步骤：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>@allure.feature(&#39;Login&#39;)

def test_login_with_valid_credentials():

    with allure.step(&#39;Navigate to login page&#39;):

        # 导航到登录页面的代码

    with allure.step(&#39;Enter credentials&#39;):

        # 输入凭据的代码

    with allure.step(&#39;Submit login form&#39;):

        # 提交登录表的代码
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>环境信息</strong>：</p><ul><li>使用 <code>allure.environment</code> 在报告中添加环境信息：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>allure.environment(host=&quot;localhost&quot;, browser=&quot;Chrome&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>处理测试失败</strong>：</p><ul><li>使用 <code>allure.attach</code> 记录失败时的详细信息：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>def test_example():

    try:

        assert 1 == 2

    except AssertionError:

        allure.attach(&#39;Error message&#39;, &#39;Test failed because 1 is not equal to 2&#39;)

        raise
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>命令行工具</strong>：</p><ul><li>使用 Allure 命令行工具来生成、查看和清理报告：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>allure generate /path/to/allure-results -o /path/to/allure-report

allure open /path/to/allure-report

allure clean
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>集成到 CI/CD</strong>：</p></li><li><p>将 Allure 报告集成到持续集成/持续部署（CI/CD）流程中，例如使用 Jenkins、GitLab CI、Travis CI 等。</p></li></ul><h3 id="在报告中显示期待结果和实际结果" tabindex="-1"><a class="header-anchor" href="#在报告中显示期待结果和实际结果"><span>在报告中显示期待结果和实际结果</span></a></h3><p>在Allure报告中，期待结果（Expected Result）和实际结果（Actual Result）通常是通过Allure的参数和附件功能来展示的。以下是一些常见的方法来在Allure报告中显示期待结果和实际结果：</p><ol><li>使用参数（Parameters）: 你可以使用Allure的参数功能来添加期待结果和实际结果作为测试信息的元数据。这些参数会在测试结果中显示。</li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> os

<span class="token keyword">import</span> allure

<span class="token keyword">import</span> pytest

<span class="token keyword">def</span> <span class="token function">test_add_numbers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">&quot;Define expected results&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        expected_result <span class="token operator">=</span> <span class="token number">10</span>

        allure<span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Expected result: </span><span class="token interpolation"><span class="token punctuation">{</span>expected_result<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Expected Results&quot;</span><span class="token punctuation">)</span>

    actual_result <span class="token operator">=</span> add_numbers<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

    <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">&quot;Attach actual results&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        allure<span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Actual result: </span><span class="token interpolation"><span class="token punctuation">{</span>actual_result<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Actual Results&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">assert</span> expected_result <span class="token operator">==</span> actual_result

<span class="token keyword">def</span> <span class="token function">add_numbers</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">return</span> a <span class="token operator">+</span> b

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>

    pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;--alluredir&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;./reports&#39;</span><span class="token punctuation">,</span> __file__<span class="token punctuation">]</span><span class="token punctuation">)</span>

    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">&#39;allure serve reports&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行后的结果为：</p><h3 id="作业-登录测试练习" tabindex="-1"><a class="header-anchor" href="#作业-登录测试练习"><span>作业：登录测试练习</span></a></h3><p>我们将访问一个示例网站<a href="https://www.saucedemo.com/" target="_blank" rel="noopener noreferrer">https://www.saucedemo.com/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，测试其登录功能。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token keyword">import</span> csv

<span class="token keyword">import</span> os

<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

<span class="token keyword">import</span> allure

<span class="token keyword">import</span> pytest

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token keyword">def</span> <span class="token function">read_users_from_csv</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>

    users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>

        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictReader<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>

        <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>

            users<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> users

<span class="token keyword">class</span> <span class="token class-name">TestLogin</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># set implicit wait time</span>

        <span class="token comment"># self.driver.implicitly_wait(10)  # seconds</span>

    <span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span><span class="token string">&quot;username, password, text&quot;</span><span class="token punctuation">,</span> read_users_from_csv<span class="token punctuation">(</span><span class="token string">&#39;users.csv&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_login</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://www.saucedemo.com/&#39;</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">&quot;*[data-test=\&quot;username\&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>username<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">&quot;*[data-test=\&quot;password\&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>password<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">&quot;*[data-test=\&quot;login-button\&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># element = self.driver.find_element(By.CSS_SELECTOR, &quot;*[data-test=\&quot;title\&quot;]&quot;)</span>

        <span class="token comment"># assert self.driver.find_element(By.CSS_SELECTOR, &quot;*[data-test=\&quot;title\&quot;]&quot;).text == &quot;Products&quot;</span>

        <span class="token keyword">assert</span> text <span class="token keyword">in</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>

    pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">[</span>__file__<span class="token punctuation">,</span> <span class="token string">&#39;--alluredir&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;./reports&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">&#39;allure serve reports&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：运行<code>python TestLogin.py</code> , 不要运行<code>pytest ...</code>，否则不会执行<code>os.system(...)</code> 一行。</p><h2 id="十、jenkins安装和使用-待续" tabindex="-1"><a class="header-anchor" href="#十、jenkins安装和使用-待续"><span>十、Jenkins安装和使用（待续）</span></a></h2><ol><li><p>下载war包</p></li><li><p>命令行下运行：</p></li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>


java <span class="token operator">-</span>jar jenkins<span class="token punctuation">.</span>war <span class="token operator">-</span><span class="token operator">-</span>httpPort<span class="token operator">=</span><span class="token number">7780</span>



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中密码为</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>


Jenkins initial setup <span class="token keyword">is</span> required<span class="token punctuation">.</span> An admin user has been created <span class="token keyword">and</span> a password generated<span class="token punctuation">.</span>



Please use the following password to proceed to installation<span class="token punctuation">:</span>




64249b468ada410f9dbd40d4d3162352




This may also be found at<span class="token punctuation">:</span> <span class="token operator">/</span>home<span class="token operator">/</span>aug<span class="token operator">/</span><span class="token punctuation">.</span>jenkins<span class="token operator">/</span>secrets<span class="token operator">/</span>initialAdminPassword




</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="附录-venv的使用" tabindex="-1"><a class="header-anchor" href="#附录-venv的使用"><span>附录：venv的使用</span></a></h2><p><code>venv</code>是Python的一个标准库模块，用于创建轻量级的虚拟环境。使用<code>venv</code>可以在同一台机器上为不同的Python项目创建隔离的环境，避免版本冲突和依赖混乱。以下是<code>venv</code>的基本用法：</p><ol><li><strong>创建虚拟环境</strong> 打开命令行工具（例如终端、命令提示符或PowerShell），然后运行以下命令来创建一个新的虚拟环境：</li></ol><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>


python3 -m venv /path/to/new/virtual/environment



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里<code>/path/to/new/virtual/environment</code>是你想要存放虚拟环境的目录路径。请确保替换为实际的路径。</p><ul><li><p><strong>激活虚拟环境</strong> 创建虚拟环境后，你需要激活它才能开始使用。激活虚拟环境的方法取决于你的操作系统。</p></li><li><p>在<strong>Windows</strong>上，使用以下命令：</p></li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>


\path\to\new\virtual\environment\Scripts\activate



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在<strong>macOS</strong>和<strong>Linux</strong>上，使用以下命令：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>


source /path/to/new/virtual/environment/bin/activate



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>激活虚拟环境后，你的命令行提示符通常会显示虚拟环境的名称，表明你现在在虚拟环境中工作。</p><ul><li><strong>停用虚拟环境</strong> 当你完成工作并希望退出虚拟环境时，可以使用以下命令：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>


deactivate



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这将恢复到系统的全局Python环境。</p><ul><li><strong>安装Python包</strong> 在虚拟环境中，你可以使用<code>pip</code>命令来安装所需的Python包，例如：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>


pip install package_name



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里的<code>package_name</code>是你想要安装的Python包的名称。</p><ul><li><strong>查看已安装的包</strong> 如果你想查看当前虚拟环境中安装了哪些包，可以使用以下命令：</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>


pip list



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这将列出所有已安装的包及其版本。</p><p>使用<code>venv</code>创建和管理虚拟环境是Python开发中的最佳实践之一，它有助于保持项目的依赖清晰和独立。通过上述步骤，你可以轻松地为你的Python项目设置和使用虚拟环境。</p><h2 id="附录-浏览器控制台常见输入" tabindex="-1"><a class="header-anchor" href="#附录-浏览器控制台常见输入"><span>附录：浏览器控制台常见输入</span></a></h2><ol><li>**$x：**<strong>用于执行 XPath 查询并返回匹配该 XPath 表达式的元素列表</strong></li></ol><p>在浏览器控制台中，<code>$x</code> 是 JavaScript 的一个内置函数，用于执行 XPath 查询并返回匹配该 XPath 表达式的元素列表。</p><p>使用 <code>$x</code> 函数时，您需要传入一个 XPath 表达式作为参数，它将在当前文档中进行元素查找。返回的结果是一个由匹配的元素组成的数组。</p><p>例如，假设我们有以下 HTML 代码：</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>



  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>Item 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>



  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>Item 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>



  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>Item 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>



<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以在浏览器控制台中执行 <code>$x(&quot;//li&quot;)</code>，它将返回一个包含所有 <code>li</code> 元素的数组。</p><p>在控制台中执行 <code>$x(&quot;//li&quot;)[0]</code> 可以获取第一个匹配的 <code>li</code> 元素，执行 <code>$x(&quot;//li&quot;)[0].textContent</code> 可以获取该元素的文本内容。</p><p>总而言之，<code>$x</code> 函数是在浏览器控制台中执行 XPath 查询的一种便捷方式，它返回匹配 XPath 表达式的元素数组，可以通过索引和其他 JavaScript 操作来访问和操作这些元素。</p><h2 id="附录-f-string-格式化字符串字面量" tabindex="-1"><a class="header-anchor" href="#附录-f-string-格式化字符串字面量"><span>附录：<strong>f-string</strong>（格式化字符串字面量）</span></a></h2><p>在Python中，<code>f</code>或<code>F</code>之前的字符串被称为<strong>f-string</strong>（格式化字符串字面量），是Python 3.6及以上版本中引入的一种字符串格式化方法。f-string提供了一种非常简洁和强大的方式来嵌入表达式到字符串字面值中。</p><p>当你看到<code>logger.info(f&#39;开始执行：&#39;)</code>这样的代码时，<code>f</code>表示接下来的字符串是一个f-string，可以在大括号<code>{}</code>内部嵌入表达式。在这个例子中，<code>f&#39;开始执行：&#39;</code>中没有嵌入任何表达式，所以它实际上只是一个普通的字符串。</p><p>下面是一个包含表达式的f-string示例：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>


name = &quot;World&quot;



logger.info(f&#39;Hello, {name}!&#39;)



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>{name}</code>会被替换为变量<code>name</code>的值，所以最终输出的日志消息会是<code>Hello, World!</code>。</p><p>f-string支持任意表达式，包括函数调用和复杂表达式：</p><div class="language-Plain line-numbers-mode" data-ext="Plain" data-title="Plain"><pre class="language-Plain"><code>


logger.info(f&#39;The answer is {2 + 2}&#39;)



logger.info(f&#39;Current time: {datetime.now().strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)}&#39;)



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这些表达式会在字符串被解释时执行，并且可以将结果直接插入到字符串中。这使得f-string非常灵活和方便，特别是在需要动态生成字符串时。</p><h2 id="附录-逐行读取csv文件的内容" tabindex="-1"><a class="header-anchor" href="#附录-逐行读取csv文件的内容"><span>附录：逐行读取csv文件的内容</span></a></h2><p>如果您想要逐行读取CSV文件并取出特定的字段，您可以使用<code>pandas</code>的<code>iterrows</code>方法或者直接使用<code>csv</code>模块。以下是使用<code>pandas</code>的示例代码：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>


<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd




<span class="token comment"># 指定CSV文件的路径</span>



csv_file_path <span class="token operator">=</span> <span class="token string">&#39;path_to_your_csv_file.csv&#39;</span>




<span class="token comment"># 使用pandas的read_csv函数读取CSV文件</span>



df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>csv_file_path<span class="token punctuation">)</span>




<span class="token comment"># 初始化一个迭代器，用于逐行访问DataFrame</span>



iterator <span class="token operator">=</span> df<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span>




<span class="token comment"># 逐行取出数据</span>



<span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> iterator<span class="token punctuation">:</span>



    username <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&#39;用户名&#39;</span><span class="token punctuation">]</span>



    password <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&#39;密码&#39;</span><span class="token punctuation">]</span>



    error_message <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&#39;错误消息&#39;</span><span class="token punctuation">]</span>




    <span class="token comment"># 打印出取出的数据</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;用户名:&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;密码:&quot;</span><span class="token punctuation">,</span> password<span class="token punctuation">)</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;错误消息:&quot;</span><span class="token punctuation">,</span> error_message<span class="token punctuation">)</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 打印空行以分隔不同的记录</span>



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个代码中，<code>df.iterrows()</code>返回一个迭代器，它逐行访问DataFrame的每一行。<code>iterrows</code>每次迭代返回一个元组，其中包含索引和该行的数据（作为一个Series对象）。然后，我们可以通过列名来访问每一行的特定字段。</p><p>如果您想要使用<code>csv</code>模块来逐行读取CSV文件，代码如下：</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>


<span class="token keyword">import</span> csv




<span class="token comment"># 指定CSV文件的路径</span>



csv_file_path <span class="token operator">=</span> <span class="token string">&#39;path_to_your_csv_file.csv&#39;</span>




<span class="token comment"># 打开CSV文件</span>



<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csv_file_path<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&#39;r&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>



    <span class="token comment"># 创建CSV阅读器</span>



    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictReader<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>




    <span class="token comment"># 逐行读取</span>



    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>



        username <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&#39;用户名&#39;</span><span class="token punctuation">]</span>



        password <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&#39;密码&#39;</span><span class="token punctuation">]</span>



        error_message <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&#39;错误消息&#39;</span><span class="token punctuation">]</span>




        <span class="token comment"># 打印出取出的数据</span>



        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;用户名:&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span>



        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;密码:&quot;</span><span class="token punctuation">,</span> password<span class="token punctuation">)</span>



        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;错误消息:&quot;</span><span class="token punctuation">,</span> error_message<span class="token punctuation">)</span>



        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 打印空行以分隔不同的记录</span>




</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个代码中，<code>csv.DictReader</code>类创建一个阅读器对象，它将CSV文件的每一行解析为一个字典，字典的键是列名。然后，我们可以通过列名来访问每一行的特定字段。</p><h2 id="附录-一个不理解的问题" tabindex="-1"><a class="header-anchor" href="#附录-一个不理解的问题"><span>附录：一个不理解的问题</span></a></h2><p>运行python test_module.py, 所有测试将被执行两次。而加上if __name__ == &quot;__main__&quot;，就只会运行一次。运行一次才是正常的行为。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>


<span class="token comment"># 文件名： test_module.py</span>




<span class="token keyword">import</span> pytest




<span class="token keyword">def</span> <span class="token function">setup_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;模块级别的 setup&#39;</span><span class="token punctuation">)</span>



    <span class="token comment"># 这里准备测试所需的资源</span>




<span class="token keyword">def</span> <span class="token function">teardown_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;模块级别的 teardown&#39;</span><span class="token punctuation">)</span>



    <span class="token comment"># 这里清理测试资源</span>




<span class="token keyword">def</span> <span class="token function">test_example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;执行测试前&quot;</span><span class="token punctuation">)</span>



    <span class="token comment"># 测试代码</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;执行测试后&quot;</span><span class="token punctuation">)</span>




<span class="token keyword">def</span> <span class="token function">test_another</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;另一个测试前&quot;</span><span class="token punctuation">)</span>



    <span class="token comment"># 另一个测试代码</span>



    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;另一个测试后&quot;</span><span class="token punctuation">)</span>




<span class="token comment"># 运行python test_module.py, 所有测试将被执行两次。而加上if __name__ == &quot;__main__&quot;，就只会运行一次。运行一次才是正常的行为。</span>



<span class="token comment"># if __name__ == &quot;__main__&quot;:</span>



pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>




</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="附录-参考资料" tabindex="-1"><a class="header-anchor" href="#附录-参考资料"><span>附录：参考资料</span></a></h2><ol><li><p>Selenium Python Tutorial [<a href="https://www.geeksforgeeks.org/selenium-python-tutorial/?ref=lbp" target="_blank" rel="noopener noreferrer">https://www.geeksforgeeks.org/selenium-python-tutorial<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>]</p></li><li><p><a href="https://www.bilibili.com/video/BV1vX4y1d74i" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1vX4y1d74i<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="https://www.bilibili.com/video/BV1BS4y1g74o" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1BS4y1g74o<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p>Selenium with Python中文翻译文档 [<a href="https://selenium-python-zh.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">https://selenium-python-zh.readthedocs.io/en/latest/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>]</p></li></ol></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script src="/blog/assets/js/runtime~app.ef20b161.js" defer></script><script src="/blog/assets/js/565.4944daae.js" defer></script><script src="/blog/assets/js/app.925ce17f.js" defer></script>
  </body>
</html>
